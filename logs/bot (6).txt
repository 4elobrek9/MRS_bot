2025-07-18 16:09:29,577 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 16:09:29,746 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 16:09:29,747 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 16:09:29,747 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 16:09:29,747 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 16:09:29,747 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000018984381760>
2025-07-18 16:09:29,748 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000018984381760> completed
2025-07-18 16:09:29,749 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 16:09:29,749 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 16:09:29,749 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000189843494E0>)
2025-07-18 16:09:29,749 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000189843494E0>) completed
2025-07-18 16:09:29,750 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000018984385B40>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 16:09:29,750 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000018984385B40>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 16:09:29,750 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000018984385B40>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 16:09:29,751 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000018984385B40>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 16:09:29,751 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000018984385B40>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 16:09:29,751 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000018984385B40>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 16:09:29,751 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000189843494E0>)
2025-07-18 16:09:29,752 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000189843494E0>) completed
2025-07-18 16:09:29,752 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 16:09:29,753 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 16:09:29,753 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 16:09:29,753 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 16:09:29,753 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000018984381A80>
2025-07-18 16:09:29,754 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000018984381A80> completed
2025-07-18 16:09:29,754 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 16:09:29,754 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 16:09:29,755 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 16:09:29,755 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 16:09:29,755 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 16:09:29,756 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 16:09:29,756 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 16:09:29,756 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 16:09:29,756 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 16:09:29,757 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 16:09:29,757 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 16:09:29,757 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 16:09:29,758 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 16:09:29,758 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 16:09:29,758 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 16:09:29,759 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 16:09:29,759 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 16:09:29,759 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000189843497B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 16:09:29,759 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000189843497B0>)
2025-07-18 16:09:29,759 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000189843497B0>) completed
2025-07-18 16:09:29,760 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000189843497B0>)
2025-07-18 16:09:29,760 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000189843497B0>) completed
2025-07-18 16:09:29,760 - INFO - database - Database initialized successfully.
2025-07-18 16:09:29,760 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 16:09:29,761 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 16:09:29,761 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 16:09:29,761 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 16:09:29,761 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 16:09:29,761 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 16:09:29,762 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 16:09:29,762 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 16:09:29,762 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 16:09:29,763 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 16:09:29,763 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt
2025-07-18 16:09:29,764 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt.
2025-07-18 16:09:29,764 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'схватить за шею', 'толкнуть сильно', 'список действий', 'почесать спинку', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'спеть песню', 'разозлиться', 'попрощаться', 'рп действия', 'поцеловать', 'испугаться', 'подмигнуть', 'команды рп', 'издеваться', 'превратить', 'засмеяться', 'заплакать', 'удивиться', 'постучать', 'успокоить', 'список рп', 'погладить', 'похлопать', 'покормить', 'подрочить', 'помахать', 'работать', 'шлепнуть', 'здоровье', 'толкнуть', 'схватить', 'обозвать', 'полечить', 'ущипнуть', 'пощечина', 'трахнуть', 'кивнуть', 'напоить', 'плюнуть', 'ударить', 'укусить', 'магазин', 'шепнуть', 'профиль', 'обидеть', 'моё хп', 'уебать', 'обнять', 'мое хп', 'пнуть', 'топ', 'хп']
2025-07-18 16:09:29,765 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 16:09:29,765 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 16:09:29,766 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 16:09:29,767 - CRITICAL - core.main.ez_main - main: Необработанное исключение при основном выполнении: At least one command should be specified
Traceback (most recent call last):
  File "c:\4chan\.GITHUB\MRS_bot\main.py", line 160, in <module>
    asyncio.run(main())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 686, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "c:\4chan\.GITHUB\MRS_bot\main.py", line 78, in main
    group_text_router.message.filter(~Command())
                                     ^^^^^^^^^
  File "C:\Users\aboby\AppData\Roaming\Python\Python312\site-packages\aiogram\filters\command.py", line 96, in __init__
    raise ValueError("At least one command should be specified")
ValueError: At least one command should be specified
2025-07-18 16:53:22,501 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 16:53:22,679 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 16:53:22,680 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 16:53:22,680 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 16:53:22,680 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 16:53:22,680 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F341760>
2025-07-18 16:53:22,681 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F341760> completed
2025-07-18 16:53:22,681 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 16:53:22,681 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 16:53:22,681 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000002254F3094E0>)
2025-07-18 16:53:22,681 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000002254F3094E0>) completed
2025-07-18 16:53:22,681 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002254F345B40>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 16:53:22,681 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002254F345B40>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 16:53:22,682 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002254F345B40>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 16:53:22,682 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002254F345B40>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 16:53:22,682 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002254F345B40>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 16:53:22,682 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002254F345B40>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 16:53:22,683 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000002254F3094E0>)
2025-07-18 16:53:22,683 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000002254F3094E0>) completed
2025-07-18 16:53:22,683 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 16:53:22,683 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 16:53:22,683 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 16:53:22,683 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 16:53:22,684 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F3419E0>
2025-07-18 16:53:22,685 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F3419E0> completed
2025-07-18 16:53:22,685 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 16:53:22,685 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 16:53:22,685 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 16:53:22,686 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 16:53:22,686 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 16:53:22,686 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 16:53:22,686 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 16:53:22,686 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 16:53:22,687 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 16:53:22,687 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 16:53:22,687 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 16:53:22,687 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 16:53:22,688 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 16:53:22,688 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 16:53:22,688 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 16:53:22,688 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 16:53:22,688 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 16:53:22,689 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F3097B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 16:53:22,689 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000002254F3097B0>)
2025-07-18 16:53:22,689 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000002254F3097B0>) completed
2025-07-18 16:53:22,690 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F3097B0>)
2025-07-18 16:53:22,690 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F3097B0>) completed
2025-07-18 16:53:22,690 - INFO - database - Database initialized successfully.
2025-07-18 16:53:22,690 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 16:53:22,691 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 16:53:22,691 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 16:53:22,691 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 16:53:22,692 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 16:53:22,692 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 16:53:22,692 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 16:53:22,692 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 16:53:22,692 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 16:53:22,693 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 16:53:22,693 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt
2025-07-18 16:53:22,693 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt.
2025-07-18 16:53:22,693 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'толкнуть сильно', 'почесать спинку', 'список действий', 'схватить за шею', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'мое здоровье', 'моё здоровье', 'спеть песню', 'разозлиться', 'попрощаться', 'рп действия', 'издеваться', 'превратить', 'засмеяться', 'испугаться', 'подмигнуть', 'поцеловать', 'команды рп', 'заплакать', 'похлопать', 'список рп', 'покормить', 'удивиться', 'подрочить', 'погладить', 'постучать', 'успокоить', 'схватить', 'пощечина', 'трахнуть', 'полечить', 'работать', 'помахать', 'шлепнуть', 'здоровье', 'ущипнуть', 'обозвать', 'толкнуть', 'кивнуть', 'обидеть', 'плюнуть', 'шепнуть', 'ударить', 'укусить', 'напоить', 'магазин', 'профиль', 'уебать', 'мое хп', 'обнять', 'моё хп', 'пнуть', 'топ', 'хп']
2025-07-18 16:53:22,694 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 16:53:22,694 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 16:53:22,694 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 16:53:22,694 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 16:53:22,694 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 16:53:22,695 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 16:53:22,695 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 16:53:22,695 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 16:53:22,695 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 16:53:22,696 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 16:53:22,697 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 16:53:22,697 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 16:53:22,698 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 16:53:22,698 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 16:53:22,698 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 16:53:22,698 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 16:53:22,698 - INFO - aiogram.dispatcher - Start polling
2025-07-18 16:53:22,698 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 16:53:22,699 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 16:53:22,699 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 16:53:23,932 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 16:53:24,196 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'профиль' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 16:53:24,196 - DEBUG - censor_module - censor_message_handler: Сообщение 'профиль' является известной не-слеш командой 'профиль'. Пропускаем цензуру.
2025-07-18 16:53:24,196 - INFO - aiogram.event - Update id=836455725 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 16:54:22,703 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F37F240>
2025-07-18 16:54:22,704 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F37F240> completed
2025-07-18 16:54:22,704 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752846862.7031932))
2025-07-18 16:54:22,704 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752846862.7031932)) completed
2025-07-18 16:54:22,704 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 16:54:22,705 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 16:54:22,705 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 16:54:22,705 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 16:54:22,705 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>)
2025-07-18 16:54:22,705 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>) completed
2025-07-18 16:55:22,714 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F37F4C0>
2025-07-18 16:55:22,715 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F37F4C0> completed
2025-07-18 16:55:22,715 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B010>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752846922.714554))
2025-07-18 16:55:22,716 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B010>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752846922.714554)) completed
2025-07-18 16:55:22,716 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 16:55:22,717 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 16:55:22,717 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 16:55:22,717 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 16:55:22,717 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B010>)
2025-07-18 16:55:22,718 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B010>) completed
2025-07-18 16:56:22,727 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F343E20>
2025-07-18 16:56:22,727 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F343E20> completed
2025-07-18 16:56:22,728 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752846982.7272384))
2025-07-18 16:56:22,728 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752846982.7272384)) completed
2025-07-18 16:56:22,729 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 16:56:22,729 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 16:56:22,730 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 16:56:22,730 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 16:56:22,730 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>)
2025-07-18 16:56:22,730 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>) completed
2025-07-18 16:57:22,754 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F343E20>
2025-07-18 16:57:22,755 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F343E20> completed
2025-07-18 16:57:22,755 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847042.7548988))
2025-07-18 16:57:22,755 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847042.7548988)) completed
2025-07-18 16:57:22,756 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 16:57:22,756 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 16:57:22,756 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 16:57:22,756 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 16:57:22,757 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>)
2025-07-18 16:57:22,757 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>) completed
2025-07-18 16:58:22,761 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F343E20>
2025-07-18 16:58:22,761 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F343E20> completed
2025-07-18 16:58:22,761 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847102.760819))
2025-07-18 16:58:22,762 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847102.760819)) completed
2025-07-18 16:58:22,762 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 16:58:22,762 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 16:58:22,763 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 16:58:22,763 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 16:58:22,763 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>)
2025-07-18 16:58:22,763 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>) completed
2025-07-18 16:59:22,762 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F341800>
2025-07-18 16:59:22,763 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F341800> completed
2025-07-18 16:59:22,763 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847162.7620854))
2025-07-18 16:59:22,763 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847162.7620854)) completed
2025-07-18 16:59:22,764 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 16:59:22,764 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 16:59:22,764 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 16:59:22,765 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 16:59:22,765 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>)
2025-07-18 16:59:22,765 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>) completed
2025-07-18 17:00:22,771 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F343E20>
2025-07-18 17:00:22,772 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F343E20> completed
2025-07-18 17:00:22,772 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847222.7714603))
2025-07-18 17:00:22,773 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847222.7714603)) completed
2025-07-18 17:00:22,773 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 17:00:22,774 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 17:00:22,774 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 17:00:22,774 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 17:00:22,774 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>)
2025-07-18 17:00:22,775 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>) completed
2025-07-18 17:01:22,774 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x00000225432F40E0>
2025-07-18 17:01:22,775 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x00000225432F40E0> completed
2025-07-18 17:01:22,775 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847282.774103))
2025-07-18 17:01:22,776 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847282.774103)) completed
2025-07-18 17:01:22,776 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 17:01:22,776 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 17:01:22,776 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>)
2025-07-18 17:01:22,776 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DF040>) completed
2025-07-18 17:01:22,777 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>)
2025-07-18 17:01:22,777 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>) completed
2025-07-18 17:02:22,787 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x00000225432F40E0>
2025-07-18 17:02:22,788 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x00000225432F40E0> completed
2025-07-18 17:02:22,788 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847342.7870252))
2025-07-18 17:02:22,789 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847342.7870252)) completed
2025-07-18 17:02:22,789 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F3F84C0>)
2025-07-18 17:02:22,790 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F3F84C0>) completed
2025-07-18 17:02:22,790 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F3F84C0>)
2025-07-18 17:02:22,790 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F3F84C0>) completed
2025-07-18 17:02:22,790 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>)
2025-07-18 17:02:22,790 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>) completed
2025-07-18 17:03:22,787 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F343E20>
2025-07-18 17:03:22,788 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F343E20> completed
2025-07-18 17:03:22,788 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847402.7871227))
2025-07-18 17:03:22,788 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847402.7871227)) completed
2025-07-18 17:03:22,789 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 17:03:22,789 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 17:03:22,789 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 17:03:22,789 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 17:03:22,790 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>)
2025-07-18 17:03:22,790 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>) completed
2025-07-18 17:04:22,794 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F343E20>
2025-07-18 17:04:22,795 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F343E20> completed
2025-07-18 17:04:22,795 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847462.7943277))
2025-07-18 17:04:22,796 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847462.7943277)) completed
2025-07-18 17:04:22,796 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 17:04:22,796 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 17:04:22,796 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 17:04:22,797 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 17:04:22,797 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>)
2025-07-18 17:04:22,797 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>) completed
2025-07-18 17:05:22,807 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F343E20>
2025-07-18 17:05:22,808 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F343E20> completed
2025-07-18 17:05:22,808 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847522.8072956))
2025-07-18 17:05:22,808 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30A6B0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847522.8072956)) completed
2025-07-18 17:05:22,809 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 17:05:22,809 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 17:05:22,809 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>)
2025-07-18 17:05:22,810 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F2DEF40>) completed
2025-07-18 17:05:22,810 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>)
2025-07-18 17:05:22,810 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30A6B0>) completed
2025-07-18 17:06:22,822 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002254F341800>
2025-07-18 17:06:22,823 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002254F341800> completed
2025-07-18 17:06:22,823 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847582.8223472))
2025-07-18 17:06:22,824 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000002254F30B100>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847582.8223472)) completed
2025-07-18 17:06:22,824 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F3F8140>)
2025-07-18 17:06:22,824 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002254F3F8140>) completed
2025-07-18 17:06:22,824 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F3F8140>)
2025-07-18 17:06:22,824 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002254F3F8140>) completed
2025-07-18 17:06:22,825 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>)
2025-07-18 17:06:22,825 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F30B100>) completed
2025-07-18 17:06:46,536 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 17:06:46,799 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 17:06:46,799 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 17:06:46,799 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 17:06:46,799 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F3094E0>)
2025-07-18 17:06:46,800 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000002254F3094E0>) completed
2025-07-18 17:06:46,800 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 17:06:46,800 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 17:06:46,800 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 17:06:46,800 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 17:06:46,801 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 17:07:26,546 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 17:07:26,712 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 17:07:26,713 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 17:07:26,713 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 17:07:26,713 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 17:07:26,714 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C14E0>
2025-07-18 17:07:26,714 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C14E0> completed
2025-07-18 17:07:26,714 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 17:07:26,714 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 17:07:26,715 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001D4414895D0>)
2025-07-18 17:07:26,715 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001D4414895D0>) completed
2025-07-18 17:07:26,715 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001D4414AD9C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 17:07:26,716 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001D4414AD9C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 17:07:26,716 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001D4414AD9C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 17:07:26,716 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001D4414AD9C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 17:07:26,716 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001D4414AD9C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 17:07:26,716 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001D4414AD9C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 17:07:26,717 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001D4414895D0>)
2025-07-18 17:07:26,717 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001D4414895D0>) completed
2025-07-18 17:07:26,717 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 17:07:26,718 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 17:07:26,718 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 17:07:26,718 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 17:07:26,718 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1760>
2025-07-18 17:07:26,718 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1760> completed
2025-07-18 17:07:26,718 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 17:07:26,719 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 17:07:26,719 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 17:07:26,719 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 17:07:26,720 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 17:07:26,720 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 17:07:26,721 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 17:07:26,721 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 17:07:26,721 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 17:07:26,721 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 17:07:26,722 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 17:07:26,722 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 17:07:26,722 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 17:07:26,723 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 17:07:26,723 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 17:07:26,724 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 17:07:26,725 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 17:07:26,725 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D4414898A0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 17:07:26,725 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001D4414898A0>)
2025-07-18 17:07:26,725 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001D4414898A0>) completed
2025-07-18 17:07:26,725 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D4414898A0>)
2025-07-18 17:07:26,725 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D4414898A0>) completed
2025-07-18 17:07:26,725 - INFO - database - Database initialized successfully.
2025-07-18 17:07:26,725 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 17:07:26,726 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 17:07:26,726 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 17:07:26,726 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 17:07:26,727 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 17:07:26,727 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 17:07:26,727 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 17:07:26,727 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 17:07:26,727 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 17:07:26,727 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 17:07:26,727 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt
2025-07-18 17:07:26,728 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt.
2025-07-18 17:07:26,728 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'список действий', 'почесать спинку', 'толкнуть сильно', 'схватить за шею', 'сделать массаж', 'подарить цветы', 'прижать к себе', 'моё здоровье', 'мое здоровье', 'попрощаться', 'рп действия', 'спеть песню', 'разозлиться', 'испугаться', 'поцеловать', 'засмеяться', 'превратить', 'подмигнуть', 'издеваться', 'команды рп', 'постучать', 'успокоить', 'подрочить', 'покормить', 'список рп', 'похлопать', 'заплакать', 'погладить', 'удивиться', 'шлепнуть', 'пощечина', 'схватить', 'полечить', 'трахнуть', 'толкнуть', 'помахать', 'ущипнуть', 'обозвать', 'здоровье', 'работать', 'магазин', 'обидеть', 'плюнуть', 'напоить', 'укусить', 'ударить', 'профиль', 'кивнуть', 'шепнуть', 'мое хп', 'уебать', 'обнять', 'моё хп', 'пнуть', 'топ', 'хп']
2025-07-18 17:07:26,728 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 17:07:26,728 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 17:07:26,728 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 17:07:26,729 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 17:07:26,729 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 17:07:26,729 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 17:07:26,730 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 17:07:26,730 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 17:07:26,730 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 17:07:26,730 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 17:07:26,731 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 17:07:26,732 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 17:07:26,732 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 17:07:26,732 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 17:07:26,732 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 17:07:26,733 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 17:07:26,733 - INFO - aiogram.dispatcher - Start polling
2025-07-18 17:07:26,733 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 17:07:26,733 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 17:07:26,733 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 17:07:28,166 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 17:08:26,756 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:08:26,757 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:08:26,758 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847706.7563317))
2025-07-18 17:08:26,758 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847706.7563317)) completed
2025-07-18 17:08:26,758 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:08:26,758 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:08:26,759 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:08:26,759 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:08:26,759 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:08:26,760 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:09:26,762 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:09:26,763 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:09:26,763 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148B010>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847766.762211))
2025-07-18 17:09:26,764 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148B010>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847766.762211)) completed
2025-07-18 17:09:26,764 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:09:26,765 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:09:26,765 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:09:26,765 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:09:26,766 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148B010>)
2025-07-18 17:09:26,766 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148B010>) completed
2025-07-18 17:10:26,770 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4354040E0>
2025-07-18 17:10:26,770 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4354040E0> completed
2025-07-18 17:10:26,771 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847826.7703524))
2025-07-18 17:10:26,771 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847826.7703524)) completed
2025-07-18 17:10:26,771 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:10:26,772 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:10:26,772 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:10:26,772 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:10:26,772 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:10:26,772 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:11:26,782 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1940>
2025-07-18 17:11:26,783 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1940> completed
2025-07-18 17:11:26,783 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847886.78222))
2025-07-18 17:11:26,784 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847886.78222)) completed
2025-07-18 17:11:26,784 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:11:26,784 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:11:26,784 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:11:26,785 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:11:26,785 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:11:26,785 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:12:26,792 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:12:26,793 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:12:26,793 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847946.792497))
2025-07-18 17:12:26,793 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752847946.792497)) completed
2025-07-18 17:12:26,794 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:12:26,794 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:12:26,794 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:12:26,794 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:12:26,795 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:12:26,795 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:13:26,801 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1580>
2025-07-18 17:13:26,802 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1580> completed
2025-07-18 17:13:26,802 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848006.8015223))
2025-07-18 17:13:26,803 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848006.8015223)) completed
2025-07-18 17:13:26,803 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B0C0>)
2025-07-18 17:13:26,803 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B0C0>) completed
2025-07-18 17:13:26,804 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B0C0>)
2025-07-18 17:13:26,804 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B0C0>) completed
2025-07-18 17:13:26,804 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:13:26,805 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:14:26,813 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1580>
2025-07-18 17:14:26,814 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1580> completed
2025-07-18 17:14:26,814 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848066.813321))
2025-07-18 17:14:26,814 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848066.813321)) completed
2025-07-18 17:14:26,815 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:14:26,815 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:14:26,815 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:14:26,816 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:14:26,816 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:14:26,816 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:15:26,826 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4354040E0>
2025-07-18 17:15:26,826 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4354040E0> completed
2025-07-18 17:15:26,827 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848126.8258824))
2025-07-18 17:15:26,828 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848126.8258824)) completed
2025-07-18 17:15:26,828 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B0C0>)
2025-07-18 17:15:26,828 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B0C0>) completed
2025-07-18 17:15:26,828 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B0C0>)
2025-07-18 17:15:26,828 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B0C0>) completed
2025-07-18 17:15:26,829 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:15:26,829 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:16:26,831 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:16:26,831 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:16:26,832 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848186.8317752))
2025-07-18 17:16:26,832 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848186.8317752)) completed
2025-07-18 17:16:26,833 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B0C0>)
2025-07-18 17:16:26,833 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B0C0>) completed
2025-07-18 17:16:26,833 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B0C0>)
2025-07-18 17:16:26,833 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B0C0>) completed
2025-07-18 17:16:26,834 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:16:26,834 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:17:26,843 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:17:26,844 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:17:26,844 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848246.8439903))
2025-07-18 17:17:26,845 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848246.8439903)) completed
2025-07-18 17:17:26,845 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B8C0>)
2025-07-18 17:17:26,845 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B8C0>) completed
2025-07-18 17:17:26,845 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B8C0>)
2025-07-18 17:17:26,845 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B8C0>) completed
2025-07-18 17:17:26,845 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:17:26,846 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:18:26,844 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1580>
2025-07-18 17:18:26,844 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1580> completed
2025-07-18 17:18:26,844 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848306.8433235))
2025-07-18 17:18:26,845 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848306.8433235)) completed
2025-07-18 17:18:26,845 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B0C0>)
2025-07-18 17:18:26,845 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B0C0>) completed
2025-07-18 17:18:26,845 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B0C0>)
2025-07-18 17:18:26,846 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B0C0>) completed
2025-07-18 17:18:26,846 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:18:26,846 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:19:26,847 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1940>
2025-07-18 17:19:26,847 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1940> completed
2025-07-18 17:19:26,848 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848366.8471699))
2025-07-18 17:19:26,848 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848366.8471699)) completed
2025-07-18 17:19:26,848 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B8C0>)
2025-07-18 17:19:26,849 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145B8C0>) completed
2025-07-18 17:19:26,849 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B8C0>)
2025-07-18 17:19:26,849 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145B8C0>) completed
2025-07-18 17:19:26,849 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:19:26,850 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:20:26,860 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1940>
2025-07-18 17:20:26,861 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1940> completed
2025-07-18 17:20:26,861 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848426.8601096))
2025-07-18 17:20:26,862 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848426.8601096)) completed
2025-07-18 17:20:26,862 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:20:26,862 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:20:26,862 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:20:26,863 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:20:26,863 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:20:26,863 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:21:26,875 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1580>
2025-07-18 17:21:26,876 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1580> completed
2025-07-18 17:21:26,876 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848486.8754365))
2025-07-18 17:21:26,876 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848486.8754365)) completed
2025-07-18 17:21:26,877 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:21:26,877 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:21:26,877 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:21:26,877 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:21:26,878 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:21:26,878 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:22:26,884 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1580>
2025-07-18 17:22:26,885 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1580> completed
2025-07-18 17:22:26,885 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848546.8841643))
2025-07-18 17:22:26,886 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848546.8841643)) completed
2025-07-18 17:22:26,886 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:22:26,886 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:22:26,886 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:22:26,886 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:22:26,887 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:22:26,887 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:23:26,913 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1940>
2025-07-18 17:23:26,914 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1940> completed
2025-07-18 17:23:26,914 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848606.913861))
2025-07-18 17:23:26,914 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848606.913861)) completed
2025-07-18 17:23:26,915 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:23:26,915 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:23:26,915 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:23:26,915 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:23:26,916 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:23:26,916 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:24:26,934 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4354040E0>
2025-07-18 17:24:26,934 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4354040E0> completed
2025-07-18 17:24:26,935 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848666.9349535))
2025-07-18 17:24:26,935 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848666.9349535)) completed
2025-07-18 17:24:26,936 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:24:26,936 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:24:26,936 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:24:26,936 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:24:26,936 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:24:26,937 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:25:26,948 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:25:26,949 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:25:26,949 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848726.9489248))
2025-07-18 17:25:26,950 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848726.9489248)) completed
2025-07-18 17:25:26,950 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:25:26,950 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:25:26,951 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:25:26,951 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:25:26,951 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:25:26,951 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:26:26,968 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1940>
2025-07-18 17:26:26,969 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1940> completed
2025-07-18 17:26:26,969 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848786.9681816))
2025-07-18 17:26:26,970 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848786.9681816)) completed
2025-07-18 17:26:26,970 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:26:26,970 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:26:26,971 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:26:26,971 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:26:26,971 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:26:26,971 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:27:26,972 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1580>
2025-07-18 17:27:26,973 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1580> completed
2025-07-18 17:27:26,973 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848846.9720683))
2025-07-18 17:27:26,974 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848846.9720683)) completed
2025-07-18 17:27:26,974 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:27:26,974 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:27:26,975 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:27:26,975 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:27:26,975 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:27:26,975 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:28:26,973 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:28:26,974 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:28:26,974 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848906.9733038))
2025-07-18 17:28:26,974 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848906.9733038)) completed
2025-07-18 17:28:26,974 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:28:26,975 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:28:26,975 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:28:26,975 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:28:26,975 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:28:26,975 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:29:26,987 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:29:26,987 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:29:26,988 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848966.987129))
2025-07-18 17:29:26,988 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752848966.987129)) completed
2025-07-18 17:29:26,988 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:29:26,988 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:29:26,988 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:29:26,988 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:29:26,989 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:29:26,989 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:30:27,006 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1940>
2025-07-18 17:30:27,007 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1940> completed
2025-07-18 17:30:27,007 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849027.0066485))
2025-07-18 17:30:27,007 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849027.0066485)) completed
2025-07-18 17:30:27,008 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:30:27,008 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:30:27,008 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:30:27,008 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:30:27,008 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:30:27,009 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:31:27,007 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4354040E0>
2025-07-18 17:31:27,007 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4354040E0> completed
2025-07-18 17:31:27,008 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849087.0071208))
2025-07-18 17:31:27,008 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849087.0071208)) completed
2025-07-18 17:31:27,009 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:31:27,009 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:31:27,009 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:31:27,009 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:31:27,009 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:31:27,010 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:32:27,009 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1940>
2025-07-18 17:32:27,010 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1940> completed
2025-07-18 17:32:27,010 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849147.009914))
2025-07-18 17:32:27,010 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849147.009914)) completed
2025-07-18 17:32:27,011 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:32:27,011 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:32:27,011 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:32:27,011 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:32:27,012 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:32:27,012 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:33:27,029 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C3BA0>
2025-07-18 17:33:27,030 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C3BA0> completed
2025-07-18 17:33:27,031 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849207.0294652))
2025-07-18 17:33:27,031 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849207.0294652)) completed
2025-07-18 17:33:27,031 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:33:27,032 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:33:27,032 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:33:27,032 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:33:27,032 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:33:27,032 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:34:27,043 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1580>
2025-07-18 17:34:27,044 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1580> completed
2025-07-18 17:34:27,044 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849267.0435603))
2025-07-18 17:34:27,045 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849267.0435603)) completed
2025-07-18 17:34:27,045 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:34:27,045 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:34:27,046 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:34:27,046 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:34:27,046 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:34:27,047 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:35:27,063 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4354040E0>
2025-07-18 17:35:27,064 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4354040E0> completed
2025-07-18 17:35:27,064 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849327.0635886))
2025-07-18 17:35:27,065 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148AF20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849327.0635886)) completed
2025-07-18 17:35:27,065 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:35:27,065 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:35:27,066 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:35:27,066 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:35:27,066 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>)
2025-07-18 17:35:27,066 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148AF20>) completed
2025-07-18 17:36:27,070 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001D4414C1580>
2025-07-18 17:36:27,071 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001D4414C1580> completed
2025-07-18 17:36:27,072 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849387.0707862))
2025-07-18 17:36:27,072 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001D44148A7A0>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849387.0707862)) completed
2025-07-18 17:36:27,073 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:36:27,073 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:36:27,073 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>)
2025-07-18 17:36:27,073 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001D44145AFC0>) completed
2025-07-18 17:36:27,074 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>)
2025-07-18 17:36:27,074 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D44148A7A0>) completed
2025-07-18 17:36:35,228 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 17:36:35,493 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 17:36:35,493 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 17:36:35,493 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 17:36:35,494 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D4414895D0>)
2025-07-18 17:36:35,494 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001D4414895D0>) completed
2025-07-18 17:36:35,494 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 17:36:35,494 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 17:36:35,495 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 17:36:35,495 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 17:36:35,496 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 17:36:38,683 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 17:36:38,851 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 17:36:38,852 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 17:36:38,852 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 17:36:38,852 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 17:36:38,853 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000022A1D571580>
2025-07-18 17:36:38,853 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000022A1D571580> completed
2025-07-18 17:36:38,853 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 17:36:38,853 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 17:36:38,853 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022A1D5394E0>)
2025-07-18 17:36:38,854 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022A1D5394E0>) completed
2025-07-18 17:36:38,854 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022A1D5759C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 17:36:38,854 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022A1D5759C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 17:36:38,854 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022A1D5759C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 17:36:38,855 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022A1D5759C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 17:36:38,855 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022A1D5759C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 17:36:38,855 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022A1D5759C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 17:36:38,855 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022A1D5394E0>)
2025-07-18 17:36:38,855 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022A1D5394E0>) completed
2025-07-18 17:36:38,856 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 17:36:38,856 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 17:36:38,856 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 17:36:38,857 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 17:36:38,857 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000022A1D571800>
2025-07-18 17:36:38,857 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000022A1D571800> completed
2025-07-18 17:36:38,857 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 17:36:38,858 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 17:36:38,858 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 17:36:38,858 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 17:36:38,858 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 17:36:38,859 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 17:36:38,859 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 17:36:38,859 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 17:36:38,859 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 17:36:38,859 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 17:36:38,859 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 17:36:38,859 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 17:36:38,860 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 17:36:38,860 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 17:36:38,860 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 17:36:38,860 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 17:36:38,860 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 17:36:38,860 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D5397B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 17:36:38,861 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022A1D5397B0>)
2025-07-18 17:36:38,861 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022A1D5397B0>) completed
2025-07-18 17:36:38,861 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022A1D5397B0>)
2025-07-18 17:36:38,861 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022A1D5397B0>) completed
2025-07-18 17:36:38,862 - INFO - database - Database initialized successfully.
2025-07-18 17:36:38,862 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 17:36:38,863 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 17:36:38,863 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 17:36:38,863 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 17:36:38,863 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 17:36:38,863 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 17:36:38,864 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 17:36:38,864 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 17:36:38,864 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 17:36:38,864 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 17:36:38,864 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt
2025-07-18 17:36:38,865 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt.
2025-07-18 17:36:38,865 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'толкнуть сильно', 'список действий', 'схватить за шею', 'почесать спинку', 'сделать массаж', 'прижать к себе', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'разозлиться', 'спеть песню', 'рп действия', 'попрощаться', 'превратить', 'поцеловать', 'подмигнуть', 'команды рп', 'засмеяться', 'издеваться', 'испугаться', 'заплакать', 'покормить', 'постучать', 'список рп', 'подрочить', 'похлопать', 'погладить', 'удивиться', 'успокоить', 'шлепнуть', 'работать', 'здоровье', 'трахнуть', 'помахать', 'толкнуть', 'пощечина', 'схватить', 'ущипнуть', 'полечить', 'обозвать', 'шепнуть', 'плюнуть', 'обидеть', 'профиль', 'магазин', 'ударить', 'напоить', 'укусить', 'кивнуть', 'моё хп', 'уебать', 'мое хп', 'обнять', 'пнуть', 'топ', 'хп']
2025-07-18 17:36:38,865 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 17:36:38,865 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 17:36:38,865 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 17:36:38,866 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 17:36:38,866 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 17:36:38,866 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 17:36:38,866 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 17:36:38,866 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 17:36:38,866 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 17:36:38,866 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 17:36:38,867 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 17:36:38,867 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 17:36:38,868 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 17:36:38,868 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 17:36:38,868 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 17:36:38,868 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 17:36:38,868 - INFO - aiogram.dispatcher - Start polling
2025-07-18 17:36:38,868 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 17:36:38,868 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 17:36:38,869 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 17:36:39,728 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 17:36:40,936 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'профиль' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 17:36:40,936 - DEBUG - censor_module - censor_message_handler: Сообщение 'профиль' является известной не-слеш командой 'профиль'. Пропускаем цензуру.
2025-07-18 17:36:40,936 - INFO - aiogram.event - Update id=836455726 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 17:37:38,871 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000022A1D5B3100>
2025-07-18 17:37:38,872 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000022A1D5B3100> completed
2025-07-18 17:37:38,872 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D53AE30>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849458.870859))
2025-07-18 17:37:38,873 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000022A1D53AE30>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752849458.870859)) completed
2025-07-18 17:37:38,873 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022A1D50EFC0>)
2025-07-18 17:37:38,874 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022A1D50EFC0>) completed
2025-07-18 17:37:38,875 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022A1D50EFC0>)
2025-07-18 17:37:38,875 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022A1D50EFC0>) completed
2025-07-18 17:37:38,875 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022A1D53AE30>)
2025-07-18 17:37:38,876 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022A1D53AE30>) completed
2025-07-18 17:38:26,309 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 17:38:26,573 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 17:38:26,573 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 17:38:26,573 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 17:38:26,574 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022A1D5394E0>)
2025-07-18 17:38:26,574 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022A1D5394E0>) completed
2025-07-18 17:38:26,574 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 17:38:26,574 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 17:38:26,575 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 17:38:26,575 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 17:38:26,576 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 17:38:29,168 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 18:01:39,262 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 18:02:06,195 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 18:02:06,360 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 18:02:06,361 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 18:02:06,361 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 18:02:06,362 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 18:02:06,362 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001C2A49A16C0>
2025-07-18 18:02:06,363 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001C2A49A16C0> completed
2025-07-18 18:02:06,363 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 18:02:06,363 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 18:02:06,363 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C2A49694E0>)
2025-07-18 18:02:06,364 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C2A49694E0>) completed
2025-07-18 18:02:06,364 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C2A49A5AC0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 18:02:06,364 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C2A49A5AC0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 18:02:06,364 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C2A49A5AC0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 18:02:06,365 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C2A49A5AC0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 18:02:06,365 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C2A49A5AC0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 18:02:06,365 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C2A49A5AC0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 18:02:06,365 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C2A49694E0>)
2025-07-18 18:02:06,365 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C2A49694E0>) completed
2025-07-18 18:02:06,366 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 18:02:06,366 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 18:02:06,366 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 18:02:06,366 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 18:02:06,366 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001C2A49A1940>
2025-07-18 18:02:06,367 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001C2A49A1940> completed
2025-07-18 18:02:06,367 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 18:02:06,367 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 18:02:06,368 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 18:02:06,368 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 18:02:06,368 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 18:02:06,368 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 18:02:06,369 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 18:02:06,369 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 18:02:06,369 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 18:02:06,369 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 18:02:06,370 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 18:02:06,370 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 18:02:06,370 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 18:02:06,370 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 18:02:06,370 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 18:02:06,371 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 18:02:06,372 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 18:02:06,372 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001C2A49697B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 18:02:06,372 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C2A49697B0>)
2025-07-18 18:02:06,372 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C2A49697B0>) completed
2025-07-18 18:02:06,372 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001C2A49697B0>)
2025-07-18 18:02:06,373 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001C2A49697B0>) completed
2025-07-18 18:02:06,373 - INFO - database - Database initialized successfully.
2025-07-18 18:02:06,373 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 18:02:06,374 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 18:02:06,374 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 18:02:06,374 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 18:02:06,374 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 18:02:06,374 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 18:02:06,375 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 18:02:06,375 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 18:02:06,375 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 18:02:06,376 - CRITICAL - core.main.ez_main - main: Необработанное исключение при основном выполнении: setup_censor_handlers() got an unexpected keyword argument 'direct_dispatch_handlers'
Traceback (most recent call last):
  File "c:\4chan\.GITHUB\MRS_bot\main.py", line 186, in <module>
    asyncio.run(main())
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\asyncio\base_events.py", line 686, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "c:\4chan\.GITHUB\MRS_bot\main.py", line 88, in main
    censor_module.setup_censor_handlers(
TypeError: setup_censor_handlers() got an unexpected keyword argument 'direct_dispatch_handlers'
2025-07-18 18:03:36,032 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 18:03:36,199 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 18:03:36,199 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 18:03:36,199 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 18:03:36,200 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 18:03:36,200 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000012650101800>
2025-07-18 18:03:36,200 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000012650101800> completed
2025-07-18 18:03:36,201 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 18:03:36,201 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 18:03:36,201 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000126500C94E0>)
2025-07-18 18:03:36,201 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000126500C94E0>) completed
2025-07-18 18:03:36,202 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000126501097C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 18:03:36,202 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000126501097C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 18:03:36,203 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000126501097C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 18:03:36,203 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000126501097C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 18:03:36,203 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000126501097C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 18:03:36,204 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000126501097C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 18:03:36,204 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500C94E0>)
2025-07-18 18:03:36,204 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500C94E0>) completed
2025-07-18 18:03:36,205 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 18:03:36,205 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 18:03:36,205 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 18:03:36,205 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 18:03:36,206 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000012650101A80>
2025-07-18 18:03:36,206 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000012650101A80> completed
2025-07-18 18:03:36,206 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 18:03:36,207 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 18:03:36,207 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 18:03:36,207 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 18:03:36,208 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 18:03:36,208 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 18:03:36,208 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 18:03:36,208 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 18:03:36,209 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 18:03:36,209 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 18:03:36,209 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 18:03:36,209 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 18:03:36,210 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 18:03:36,210 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 18:03:36,210 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 18:03:36,211 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 18:03:36,211 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 18:03:36,211 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500C97B0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 18:03:36,211 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500C97B0>)
2025-07-18 18:03:36,211 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500C97B0>) completed
2025-07-18 18:03:36,212 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000126500C97B0>)
2025-07-18 18:03:36,212 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000126500C97B0>) completed
2025-07-18 18:03:36,212 - INFO - database - Database initialized successfully.
2025-07-18 18:03:36,212 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 18:03:36,213 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 18:03:36,213 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 18:03:36,213 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 18:03:36,213 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 18:03:36,214 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 18:03:36,214 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 18:03:36,214 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 18:03:36,215 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 18:03:36,215 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 18:03:36,215 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt
2025-07-18 18:03:36,215 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt.
2025-07-18 18:03:36,215 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'список действий', 'почесать спинку', 'схватить за шею', 'толкнуть сильно', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'рп действия', 'спеть песню', 'попрощаться', 'разозлиться', 'команды рп', 'поцеловать', 'засмеяться', 'подмигнуть', 'превратить', 'испугаться', 'издеваться', 'список рп', 'погладить', 'покормить', 'подрочить', 'похлопать', 'постучать', 'успокоить', 'заплакать', 'удивиться', 'работать', 'здоровье', 'трахнуть', 'полечить', 'толкнуть', 'схватить', 'помахать', 'шлепнуть', 'пощечина', 'ущипнуть', 'обозвать', 'профиль', 'магазин', 'напоить', 'кивнуть', 'шепнуть', 'ударить', 'укусить', 'плюнуть', 'обидеть', 'моё хп', 'мое хп', 'обнять', 'уебать', 'пнуть', 'топ', 'хп']
2025-07-18 18:03:36,216 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 18:03:36,216 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 18:03:36,216 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 18:03:36,216 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 18:03:36,217 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 18:03:36,217 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 18:03:36,217 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 18:03:36,217 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 18:03:36,217 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 18:03:36,217 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 18:03:36,218 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 18:03:36,218 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 18:03:36,219 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 18:03:36,219 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 18:03:36,219 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 18:03:36,219 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 18:03:36,219 - INFO - aiogram.dispatcher - Start polling
2025-07-18 18:03:36,219 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 18:03:36,219 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 18:03:36,219 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 18:03:37,344 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 18:03:41,115 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'профиль' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 18:03:41,116 - DEBUG - censor_module - censor_message_handler: Сообщение 'профиль' является известной не-слеш командой 'профиль'. Попытка прямого вызова обработчика.
2025-07-18 18:03:41,116 - INFO - core.group.stat.smain - DEBUG: show_profile handler entered for user 5315054003 with text 'профиль'.
2025-07-18 18:03:41,117 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000012650143880>
2025-07-18 18:03:41,117 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000012650143880> completed
2025-07-18 18:03:41,117 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAD40>, '\n            INSERT INTO users (user_id, username, first_name, last_active_ts)\n            VALUES (?, ?, ?, ?)\n            ON CONFLICT(user_id) DO UPDATE SET\n                username = excluded.username,\n                first_name = excluded.first_name,\n                last_active_ts = excluded.last_active_ts\n        ', (5315054003, 'Cel0brek', '彼岸花', 1752851021.116502))
2025-07-18 18:03:41,119 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAD40>, '\n            INSERT INTO users (user_id, username, first_name, last_active_ts)\n            VALUES (?, ?, ?, ?)\n            ON CONFLICT(user_id) DO UPDATE SET\n                username = excluded.username,\n                first_name = excluded.first_name,\n                last_active_ts = excluded.last_active_ts\n        ', (5315054003, 'Cel0brek', '彼岸花', 1752851021.116502)) completed
2025-07-18 18:03:41,119 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAD40>, "\n            INSERT OR IGNORE INTO user_modes (user_id, mode, rating_opportunities_count)\n            VALUES (?, 'saharoza', 0)\n        ", (5315054003,))
2025-07-18 18:03:41,120 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAD40>, "\n            INSERT OR IGNORE INTO user_modes (user_id, mode, rating_opportunities_count)\n            VALUES (?, 'saharoza', 0)\n        ", (5315054003,)) completed
2025-07-18 18:03:41,120 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAD40>, '\n            INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)\n        ', (5315054003,))
2025-07-18 18:03:41,120 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAD40>, '\n            INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)\n        ', (5315054003,)) completed
2025-07-18 18:03:41,121 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500CAD40>)
2025-07-18 18:03:41,123 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500CAD40>) completed
2025-07-18 18:03:41,123 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000126500CAD40>)
2025-07-18 18:03:41,124 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000126500CAD40>) completed
2025-07-18 18:03:41,124 - DEBUG - core.group.stat.smain - Fetching or creating profile for user_id: 5315054003
2025-07-18 18:03:41,124 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000126500C94E0>)
2025-07-18 18:03:41,124 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000126500C94E0>) completed
2025-07-18 18:03:41,124 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001265010B740>, '\n            INSERT INTO users (user_id, username, first_name, last_name)\n            VALUES (?, ?, ?, ?)\n            ON CONFLICT(user_id) DO UPDATE SET\n                username = excluded.username,\n                first_name = excluded.first_name,\n                last_name = excluded.last_name\n        ', (5315054003, 'Cel0brek', '彼岸花', None))
2025-07-18 18:03:41,124 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001265010B740>, '\n            INSERT INTO users (user_id, username, first_name, last_name)\n            VALUES (?, ?, ?, ?)\n            ON CONFLICT(user_id) DO UPDATE SET\n                username = excluded.username,\n                first_name = excluded.first_name,\n                last_name = excluded.last_name\n        ', (5315054003, 'Cel0brek', '彼岸花', None)) completed
2025-07-18 18:03:41,125 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500C94E0>)
2025-07-18 18:03:41,125 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500C94E0>) completed
2025-07-18 18:03:41,125 - DEBUG - core.group.stat.smain - User 5315054003 information updated/inserted in 'profiles.db users' table.
2025-07-18 18:03:41,125 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001265010B740>, '\n        INSERT OR IGNORE INTO user_profiles (user_id)\n        VALUES (?)\n        ', (5315054003,))
2025-07-18 18:03:41,126 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001265010B740>, '\n        INSERT OR IGNORE INTO user_profiles (user_id)\n        VALUES (?)\n        ', (5315054003,)) completed
2025-07-18 18:03:41,126 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500C94E0>)
2025-07-18 18:03:41,128 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000126500C94E0>) completed
2025-07-18 18:03:41,128 - DEBUG - core.group.stat.smain - User profile for 5315054003 ensured existence in 'profiles.db user_profiles' table.
2025-07-18 18:03:41,128 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001265010B740>, '\n        SELECT * FROM user_profiles WHERE user_id = ?\n        ', (5315054003,))
2025-07-18 18:03:41,128 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001265010B740>, '\n        SELECT * FROM user_profiles WHERE user_id = ?\n        ', (5315054003,)) completed
2025-07-18 18:03:41,129 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000001265010B740>)
2025-07-18 18:03:41,129 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000001265010B740>) completed
2025-07-18 18:03:41,129 - DEBUG - core.group.stat.smain - Profile data retrieved for user_id 5315054003 from profiles.db.
2025-07-18 18:03:41,129 - DEBUG - core.group.stat.smain - Display name set to: @Cel0brek for user 5315054003.
2025-07-18 18:03:41,130 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000012650143880>
2025-07-18 18:03:41,130 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000012650143880> completed
2025-07-18 18:03:41,131 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAE30>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 18:03:41,131 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAE30>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 18:03:41,131 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAE30>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 18:03:41,132 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000126500CAE30>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 18:03:41,132 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000001265010A1C0>)
2025-07-18 18:03:41,132 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000001265010A1C0>) completed
2025-07-18 18:03:41,132 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001265010A1C0>)
2025-07-18 18:03:41,132 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001265010A1C0>) completed
2025-07-18 18:03:41,132 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000126500CAE30>)
2025-07-18 18:03:41,133 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000126500CAE30>) completed
2025-07-18 18:03:41,133 - DEBUG - core.group.stat.smain - HP fetched from database.py: 84 for user 5315054003.
2025-07-18 18:03:41,133 - INFO - core.group.stat.smain - Successfully retrieved/created profile for user 5315054003.
2025-07-18 18:03:41,133 - DEBUG - core.group.stat.smain - Generating profile image for user 5315054003.
2025-07-18 18:03:41,133 - INFO - core.group.stat.smain - Starting profile image generation for user 5315054003.
2025-07-18 18:03:41,141 - INFO - core.group.stat.smain - Font 'Hlobus.ttf' loaded successfully and cached.
2025-07-18 18:03:41,141 - DEBUG - core.group.stat.smain - Fonts retrieved from cache.
2025-07-18 18:03:41,142 - DEBUG - core.group.stat.smain - Base image and draw object created for the card.
2025-07-18 18:03:41,142 - DEBUG - core.group.stat.smain - Card shadow drawn.
2025-07-18 18:03:41,142 - DEBUG - core.group.stat.smain - Background Loading: Step 1 - Attempting to load background from local path: background/defolt.jpg.
2025-07-18 18:03:41,164 - DEBUG - core.group.stat.smain - Background Loading: Step 2 - Local background image opened with PIL and converted to RGBA.
2025-07-18 18:03:41,167 - DEBUG - core.group.stat.smain - Background Loading: Step 3 - Background image resized to 672x280.
2025-07-18 18:03:41,168 - DEBUG - core.group.stat.smain - Background Loading: Step 4 - Background image cropped to fit card dimensions.
2025-07-18 18:03:41,168 - INFO - core.group.stat.smain - Background Loading: Step 5 - Rounded corner mask applied to background image.
2025-07-18 18:03:41,168 - DEBUG - core.group.stat.smain - Background image pasted onto base card.
2025-07-18 18:03:41,168 - DEBUG - core.group.stat.smain - Avatar Collection: Step 1 - Attempting to get profile photos for user ID: 5315054003 from Telegram.
2025-07-18 18:03:42,256 - INFO - core.group.stat.smain - Avatar Collection: Step 2.1 - No profile photos found for user 5315054003. Initiating fallback to default placeholder.
2025-07-18 18:03:42,256 - WARNING - core.group.stat.smain - Avatar Collection: Primary avatar retrieval failed for user 5315054003: No profile photos. Attempting to load default placeholder from URL.
Traceback (most recent call last):
  File "c:\4chan\.GITHUB\MRS_bot\core\group\stat\manager.py", line 375, in generate_profile_image
    raise ValueError("No profile photos")
ValueError: No profile photos
2025-07-18 18:03:42,257 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 1 - Attempting to download default avatar from URL: https://placehold.co/120x120/CCCCCC/FFFFFF/png?text=AV.
2025-07-18 18:03:42,987 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 2 - Default avatar downloaded. Opening with PIL and converting to RGBA.
2025-07-18 18:03:42,987 - DEBUG - PIL.PngImagePlugin - STREAM b'IHDR' 16 13
2025-07-18 18:03:42,988 - DEBUG - PIL.PngImagePlugin - STREAM b'pHYs' 41 9
2025-07-18 18:03:42,988 - DEBUG - PIL.PngImagePlugin - STREAM b'IDAT' 62 1369
2025-07-18 18:03:42,989 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 3 - Resizing default avatar to 120x120.
2025-07-18 18:03:42,989 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 4 - Creating circular mask for the default avatar.
2025-07-18 18:03:42,989 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 5 - Applying mask to default avatar to make it circular.
2025-07-18 18:03:42,989 - INFO - core.group.stat.smain - Avatar Collection: Default avatar placeholder loaded successfully from URL.
2025-07-18 18:03:42,989 - DEBUG - core.group.stat.smain - Avatar Collection: Pasting the determined avatar image onto the base card image.
2025-07-18 18:03:42,989 - DEBUG - core.group.stat.smain - Avatar pasted onto base image.
2025-07-18 18:03:42,990 - DEBUG - core.group.stat.smain - Coin icon drawn on avatar.
2025-07-18 18:03:42,990 - DEBUG - core.group.stat.smain - Profile data for image: Display Name: @Cel0brek, Level: 1, EXP: 11, Lumcoins: 103, HP: 84.
2025-07-18 18:03:42,991 - DEBUG - core.group.stat.smain - Text '@Cel0brek' drawn with shadow at (165, 84).
2025-07-18 18:03:42,991 - DEBUG - core.group.stat.smain - Left-central text block (username) drawn.
2025-07-18 18:03:42,991 - DEBUG - core.group.stat.smain - Calculating required EXP for level 1.
2025-07-18 18:03:42,991 - DEBUG - core.group.stat.smain - Required EXP for level 1: 105.
2025-07-18 18:03:42,992 - DEBUG - core.group.stat.smain - Text 'Experience' drawn with shadow at (30, 205).
2025-07-18 18:03:42,992 - DEBUG - core.group.stat.smain - Experience label drawn.
2025-07-18 18:03:42,993 - DEBUG - core.group.stat.smain - EXP Bar: current_exp_percentage=0.10476190476190476, fill_width=59.
2025-07-18 18:03:42,993 - DEBUG - core.group.stat.smain - EXP bar background drawn.
2025-07-18 18:03:42,993 - DEBUG - core.group.stat.smain - EXP bar filled with green gradient with transparency.
2025-07-18 18:03:42,993 - DEBUG - core.group.stat.smain - Text '11/105' drawn with shadow at (615, 231).
2025-07-18 18:03:42,994 - DEBUG - core.group.stat.smain - Experience progress text '11/105' drawn.
2025-07-18 18:03:42,994 - DEBUG - core.group.stat.smain - Text 'HP' drawn with shadow at (651, 50).
2025-07-18 18:03:42,994 - DEBUG - core.group.stat.smain - Text '❤️ 84' drawn with shadow at (617, 75).
2025-07-18 18:03:42,994 - DEBUG - core.group.stat.smain - Right column HP text drawn.
2025-07-18 18:03:42,995 - DEBUG - core.group.stat.smain - Text 'LumCoins' drawn with shadow at (589, 120).
2025-07-18 18:03:42,995 - DEBUG - core.group.stat.smain - Text '₽ 103' drawn with shadow at (609, 145).
2025-07-18 18:03:42,995 - DEBUG - core.group.stat.smain - Right column Lumcoins text drawn.
2025-07-18 18:03:43,043 - INFO - core.group.stat.smain - Profile image generation completed for user 5315054003.
2025-07-18 18:03:43,043 - INFO - core.group.stat.smain - Sending profile image to user 5315054003.
2025-07-18 18:03:45,296 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'профиль' успешно выполнен. Завершение обработки сообщения.
2025-07-18 18:03:45,296 - INFO - aiogram.event - Update id=836455727 is handled. Duration 4187 ms by bot id=6543660809
2025-07-18 18:03:48,161 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'Я ЧЁ' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 18:03:48,162 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'Я ЧЁ'
2025-07-18 18:03:48,162 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'Я ЧЁ' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 18:03:48,162 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 18:03:48,166 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'Я ЧЁ', Было ли цензурировано: False
2025-07-18 18:03:48,166 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 18:03:48,167 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'Я ЧЁ'
2025-07-18 18:03:48,167 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 18:03:48,167 - INFO - aiogram.event - Update id=836455728 is handled. Duration 16 ms by bot id=6543660809
2025-07-18 18:03:57,771 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'НЕ ТУПОЙ ДОЛБАЁБ С ОДНОЙ ХРОМОСОМОЙ ЕБАТЬ' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 18:03:57,771 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'НЕ ТУПОЙ ДОЛБАЁБ С ОДНОЙ ХРОМОСОМОЙ ЕБАТЬ'
2025-07-18 18:03:57,771 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'НЕ ТУПОЙ ДОЛБАЁБ С ОДНОЙ ХРОМОСОМОЙ ЕБАТЬ' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 18:03:57,772 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 18:03:57,772 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 7: '^@$%@%$'
2025-07-18 18:03:57,773 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'ДОЛБАЁБ', заменено на '^@$%@%$'
2025-07-18 18:03:57,773 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 5: '@&$#%'
2025-07-18 18:03:57,773 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'ЕБАТЬ', заменено на '@&$#%'
2025-07-18 18:03:57,773 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'НЕ ТУПОЙ ^@$%@%$ С ОДНОЙ ХРОМОСОМОЙ @&$#%', Было ли цензурировано: True
2025-07-18 18:03:57,773 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=True
2025-07-18 18:03:57,773 - INFO - censor_module - censor_message_handler: ЦЕНЗУРА ОБНАРУЖЕНА: Оригинал: 'НЕ ТУПОЙ ДОЛБАЁБ С ОДНОЙ ХРОМОСОМОЙ ЕБАТЬ', Цензурировано: 'НЕ ТУПОЙ ^@$%@%$ С ОДНОЙ ХРОМОСОМОЙ @&$#%'. Найденные слова: ['ДОЛБАЁБ', 'ЕБАТЬ']
2025-07-18 18:03:57,773 - DEBUG - censor_module - censor_message_handler: Попытка удалить сообщение 2320 от пользователя 5315054003.
2025-07-18 18:03:58,175 - INFO - censor_module - censor_message_handler: Сообщение 2320 от пользователя 5315054003 УСПЕШНО удалено.
2025-07-18 18:03:58,175 - DEBUG - censor_module - censor_message_handler: Попытка отправить цензурированное сообщение в чат -1002640920461: '<b>彼岸花</b> имел в виду: "НЕ ТУПОЙ ^@$%@%$ С ОДНОЙ ХРОМОСОМОЙ @&$#%"'
2025-07-18 18:03:58,536 - INFO - censor_module - censor_message_handler: Цензурированное сообщение УСПЕШНО отправлено в чат -1002640920461.
2025-07-18 18:03:58,537 - INFO - aiogram.event - Update id=836455729 is handled. Duration 764 ms by bot id=6543660809
2025-07-18 18:04:16,125 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'поцеловать' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 18:04:16,125 - DEBUG - censor_module - censor_message_handler: Сообщение 'поцеловать' является известной не-слеш командой 'поцеловать'. Попытка прямого вызова обработчика.
2025-07-18 18:04:16,126 - ERROR - censor_module - censor_message_handler: Ошибка при прямом вызове обработчика для 'поцеловать': handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
Traceback (most recent call last):
  File "c:\4chan\.GITHUB\MRS_bot\censor_module.py", line 195, in censor_message_handler
    await handler_func(**handler_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
2025-07-18 18:04:17,003 - INFO - aiogram.event - Update id=836455730 is handled. Duration 875 ms by bot id=6543660809
2025-07-18 18:04:23,589 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'поцеловать' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 18:04:23,589 - DEBUG - censor_module - censor_message_handler: Сообщение 'поцеловать' является известной не-слеш командой 'поцеловать'. Попытка прямого вызова обработчика.
2025-07-18 18:04:23,590 - ERROR - censor_module - censor_message_handler: Ошибка при прямом вызове обработчика для 'поцеловать': handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
Traceback (most recent call last):
  File "c:\4chan\.GITHUB\MRS_bot\censor_module.py", line 195, in censor_message_handler
    await handler_func(**handler_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
2025-07-18 18:04:24,352 - INFO - aiogram.event - Update id=836455731 is handled. Duration 765 ms by bot id=6543660809
2025-07-18 18:04:36,238 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000012650103EC0>
2025-07-18 18:04:36,238 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000012650103EC0> completed
2025-07-18 18:04:36,239 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001265039E890>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752851076.238374))
2025-07-18 18:04:36,239 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001265039E890>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752851076.238374)) completed
2025-07-18 18:04:36,240 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001265010B5C0>)
2025-07-18 18:04:36,240 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001265010B5C0>) completed
2025-07-18 18:04:36,240 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001265010B5C0>)
2025-07-18 18:04:36,240 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001265010B5C0>) completed
2025-07-18 18:04:36,241 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001265039E890>)
2025-07-18 18:04:36,241 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001265039E890>) completed
2025-07-18 18:04:59,917 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 18:05:00,192 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 18:05:00,192 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 18:05:00,192 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 18:05:00,193 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000126500C94E0>)
2025-07-18 18:05:00,193 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000126500C94E0>) completed
2025-07-18 18:05:00,194 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 18:05:00,194 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 18:05:00,194 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 18:05:00,194 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 18:05:00,196 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
