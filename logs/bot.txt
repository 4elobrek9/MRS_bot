2025-07-18 15:06:15,850 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 15:06:16,014 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 15:06:16,014 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 15:06:16,014 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 15:06:16,015 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 15:06:16,015 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x00000253FFDCD4E0>
2025-07-18 15:06:16,015 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x00000253FFDCD4E0> completed
2025-07-18 15:06:16,016 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 15:06:16,016 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 15:06:16,016 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000253FFD955D0>)
2025-07-18 15:06:16,016 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000253FFD955D0>) completed
2025-07-18 15:06:16,016 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000253FFDD1740>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 15:06:16,017 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000253FFDD1740>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 15:06:16,017 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000253FFDD1740>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 15:06:16,017 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000253FFDD1740>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 15:06:16,018 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000253FFDD1740>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 15:06:16,018 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000253FFDD1740>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 15:06:16,018 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000253FFD955D0>)
2025-07-18 15:06:16,018 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000253FFD955D0>) completed
2025-07-18 15:06:16,019 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 15:06:16,019 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 15:06:16,019 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 15:06:16,019 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 15:06:16,019 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x00000253FFDCD760>
2025-07-18 15:06:16,019 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x00000253FFDCD760> completed
2025-07-18 15:06:16,020 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 15:06:16,020 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 15:06:16,021 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 15:06:16,021 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 15:06:16,021 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 15:06:16,022 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 15:06:16,022 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 15:06:16,022 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 15:06:16,022 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 15:06:16,023 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 15:06:16,023 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 15:06:16,024 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 15:06:16,024 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 15:06:16,025 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 15:06:16,025 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 15:06:16,026 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 15:06:16,026 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 15:06:16,026 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD958A0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 15:06:16,026 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000253FFD958A0>)
2025-07-18 15:06:16,027 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000253FFD958A0>) completed
2025-07-18 15:06:16,027 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD958A0>)
2025-07-18 15:06:16,027 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD958A0>) completed
2025-07-18 15:06:16,027 - INFO - database - Database initialized successfully.
2025-07-18 15:06:16,028 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 15:06:16,028 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 15:06:16,029 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 15:06:16,029 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 15:06:16,029 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 15:06:16,029 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 15:06:16,029 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 15:06:16,030 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 15:06:16,030 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 15:06:16,030 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 15:06:16,030 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt
2025-07-18 15:06:16,035 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 42 корней 'злых' слов из C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt.
2025-07-18 15:06:16,035 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 15:06:16,035 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 15:06:16,035 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 15:06:16,036 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 15:06:16,036 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 15:06:16,037 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 15:06:16,037 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 15:06:16,038 - INFO - core.main.ez_main - main: Настройка и включение роутеров RP и Stat.
2025-07-18 15:06:16,038 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 15:06:16,038 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 15:06:16,038 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 15:06:16,038 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 15:06:16,038 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 15:06:16,038 - INFO - aiogram.dispatcher - Start polling
2025-07-18 15:06:16,038 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 15:06:16,038 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 15:06:16,038 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 15:06:17,437 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 15:07:16,040 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x00000253FFDCD760>
2025-07-18 15:07:16,041 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x00000253FFDCD760> completed
2025-07-18 15:07:16,041 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD96F20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752840436.040578))
2025-07-18 15:07:16,042 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD96F20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752840436.040578)) completed
2025-07-18 15:07:16,042 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000253FFD56D40>)
2025-07-18 15:07:16,042 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000253FFD56D40>) completed
2025-07-18 15:07:16,042 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000253FFD56D40>)
2025-07-18 15:07:16,043 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000253FFD56D40>) completed
2025-07-18 15:07:16,043 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD96F20>)
2025-07-18 15:07:16,043 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD96F20>) completed
2025-07-18 15:08:16,058 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x00000253FFDCD940>
2025-07-18 15:08:16,059 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x00000253FFDCD940> completed
2025-07-18 15:08:16,059 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD97010>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752840496.0587192))
2025-07-18 15:08:16,060 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD97010>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752840496.0587192)) completed
2025-07-18 15:08:16,060 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000253FFD56D40>)
2025-07-18 15:08:16,060 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000253FFD56D40>) completed
2025-07-18 15:08:16,060 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000253FFD56D40>)
2025-07-18 15:08:16,060 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000253FFD56D40>) completed
2025-07-18 15:08:16,061 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD97010>)
2025-07-18 15:08:16,061 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD97010>) completed
2025-07-18 15:09:16,068 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x00000253F4CE00E0>
2025-07-18 15:09:16,069 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x00000253F4CE00E0> completed
2025-07-18 15:09:16,069 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD96F20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752840556.068565))
2025-07-18 15:09:16,070 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x00000253FFD96F20>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752840556.068565)) completed
2025-07-18 15:09:16,070 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000253FFD56D40>)
2025-07-18 15:09:16,070 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000253FFD56D40>) completed
2025-07-18 15:09:16,071 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000253FFD56D40>)
2025-07-18 15:09:16,071 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000253FFD56D40>) completed
2025-07-18 15:09:16,071 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD96F20>)
2025-07-18 15:09:16,071 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD96F20>) completed
2025-07-18 15:09:21,075 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'сын шлюхи блядской , чтобы твою всю семью перетрахали выблядок ебучий. жди докс выблядок' от пользователя 7175749771 в чате -1002640920461.
2025-07-18 15:09:21,075 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'сын шлюхи блядской , чтобы твою всю семью перетрахали выблядок ебучий. жди докс выблядок'
2025-07-18 15:09:21,075 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'сын шлюхи блядской , чтобы твою всю семью перетрахали выблядок ебучий. жди докс выблядок' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус']
2025-07-18 15:09:21,075 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b'
2025-07-18 15:09:21,079 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 5: '@&%#&'
2025-07-18 15:09:21,079 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'шлюхи', заменено на '@&%#&'
2025-07-18 15:09:21,079 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 8: '@%@^@^&@'
2025-07-18 15:09:21,079 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'блядской', заменено на '@%@^@^&@'
2025-07-18 15:09:21,080 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 8: '$^&@^$@%'
2025-07-18 15:09:21,080 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'выблядок', заменено на '$^&@^$@%'
2025-07-18 15:09:21,080 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 6: '#&@^%&'
2025-07-18 15:09:21,081 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'ебучий', заменено на '#&@^%&'
2025-07-18 15:09:21,081 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 8: '%&#&@$#&'
2025-07-18 15:09:21,081 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'выблядок', заменено на '%&#&@$#&'
2025-07-18 15:09:21,082 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'сын @&%#& @%@^@^&@ , чтобы твою всю семью перетрахали $^&@^$@% #&@^%&. жди докс %&#&@$#&', Было ли цензурировано: True
2025-07-18 15:09:21,082 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=True
2025-07-18 15:09:21,082 - INFO - censor_module - censor_message_handler: ЦЕНЗУРА ОБНАРУЖЕНА: Оригинал: 'сын шлюхи блядской , чтобы твою всю семью перетрахали выблядок ебучий. жди докс выблядок', Цензурировано: 'сын @&%#& @%@^@^&@ , чтобы твою всю семью перетрахали $^&@^$@% #&@^%&. жди докс %&#&@$#&'. Найденные слова: ['шлюхи', 'блядской', 'выблядок', 'ебучий', 'выблядок']
2025-07-18 15:09:21,082 - DEBUG - censor_module - censor_message_handler: Попытка удалить сообщение 2292 от пользователя 7175749771.
2025-07-18 15:09:22,058 - INFO - censor_module - censor_message_handler: Сообщение 2292 от пользователя 7175749771 УСПЕШНО удалено.
2025-07-18 15:09:22,058 - DEBUG - censor_module - censor_message_handler: Попытка отправить цензурированное сообщение в чат -1002640920461: '<b>ᅠ</b> имел в виду: "сын @&%#& @%@^@^&@ , чтобы твою всю семью перетрахали $^&@^$@% #&@^%&. жди докс %&#&@$#&"'
2025-07-18 15:09:22,595 - INFO - censor_module - censor_message_handler: Цензурированное сообщение УСПЕШНО отправлено в чат -1002640920461.
2025-07-18 15:09:22,596 - INFO - aiogram.event - Update id=836455705 is handled. Duration 1515 ms by bot id=6543660809
2025-07-18 15:09:42,282 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 15:09:42,544 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 15:09:42,544 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 15:09:42,544 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 15:09:42,544 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD955D0>)
2025-07-18 15:09:42,545 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000253FFD955D0>) completed
2025-07-18 15:09:42,545 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 15:09:42,545 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 15:09:42,545 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 15:09:42,546 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 15:09:42,546 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 15:10:07,391 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 15:10:07,563 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 15:10:07,564 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 15:10:07,564 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 15:10:07,564 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 15:10:07,565 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001BF54ADD4E0>
2025-07-18 15:10:07,566 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001BF54ADD4E0> completed
2025-07-18 15:10:07,566 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 15:10:07,566 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 15:10:07,566 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001BF54AA15D0>)
2025-07-18 15:10:07,566 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001BF54AA15D0>) completed
2025-07-18 15:10:07,566 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001BF54AE1740>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 15:10:07,567 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001BF54AE1740>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 15:10:07,568 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001BF54AE1740>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 15:10:07,568 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001BF54AE1740>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 15:10:07,569 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001BF54AE1740>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 15:10:07,569 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001BF54AE1740>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 15:10:07,570 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001BF54AA15D0>)
2025-07-18 15:10:07,570 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001BF54AA15D0>) completed
2025-07-18 15:10:07,570 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 15:10:07,570 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 15:10:07,570 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 15:10:07,570 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 15:10:07,571 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001BF54ADD760>
2025-07-18 15:10:07,571 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001BF54ADD760> completed
2025-07-18 15:10:07,571 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 15:10:07,572 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 15:10:07,572 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 15:10:07,572 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 15:10:07,572 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 15:10:07,573 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 15:10:07,573 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 15:10:07,574 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 15:10:07,574 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 15:10:07,574 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 15:10:07,575 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 15:10:07,575 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 15:10:07,575 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 15:10:07,576 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 15:10:07,576 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 15:10:07,576 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 15:10:07,576 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 15:10:07,577 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA18A0>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 15:10:07,577 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001BF54AA18A0>)
2025-07-18 15:10:07,577 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001BF54AA18A0>) completed
2025-07-18 15:10:07,577 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001BF54AA18A0>)
2025-07-18 15:10:07,578 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001BF54AA18A0>) completed
2025-07-18 15:10:07,578 - INFO - database - Database initialized successfully.
2025-07-18 15:10:07,578 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 15:10:07,579 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 15:10:07,580 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 15:10:07,580 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 15:10:07,580 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 15:10:07,580 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 15:10:07,581 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 15:10:07,581 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 15:10:07,581 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 15:10:07,581 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 15:10:07,581 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt
2025-07-18 15:10:07,582 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\4chan\.GITHUB\MRS_bot\data\bad_words.txt.
2025-07-18 15:10:07,582 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 15:10:07,582 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 15:10:07,582 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 15:10:07,582 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 15:10:07,582 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 15:10:07,583 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 15:10:07,583 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 15:10:07,584 - INFO - core.main.ez_main - main: Настройка и включение роутеров RP и Stat.
2025-07-18 15:10:07,584 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 15:10:07,584 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 15:10:07,584 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 15:10:07,584 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 15:10:07,585 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 15:10:07,585 - INFO - aiogram.dispatcher - Start polling
2025-07-18 15:10:07,585 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 15:10:07,585 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 15:10:07,585 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 15:10:08,667 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 15:10:17,119 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'Мистер большие яйца' от пользователя 7175749771 в чате -1002640920461.
2025-07-18 15:10:17,119 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'Мистер большие яйца'
2025-07-18 15:10:17,120 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'Мистер большие яйца' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 15:10:17,120 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 15:10:17,160 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'Мистер большие яйца', Было ли цензурировано: False
2025-07-18 15:10:17,160 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 15:10:17,160 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'Мистер большие яйца'
2025-07-18 15:10:17,160 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 7175749771 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 15:10:17,161 - INFO - aiogram.event - Update id=836455706 is handled. Duration 46 ms by bot id=6543660809
2025-07-18 15:10:21,656 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'профиль' от пользователя 7175749771 в чате -1002640920461.
2025-07-18 15:10:21,656 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'профиль'
2025-07-18 15:10:21,656 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'профиль' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 15:10:21,657 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 15:10:21,657 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'профиль', Было ли цензурировано: False
2025-07-18 15:10:21,657 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 15:10:21,657 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'профиль'
2025-07-18 15:10:21,658 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 7175749771 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 15:10:21,658 - INFO - aiogram.event - Update id=836455707 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 15:10:34,043 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'список рп' от пользователя 7175749771 в чате -1002640920461.
2025-07-18 15:10:34,043 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'список рп'
2025-07-18 15:10:34,044 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'список рп' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 15:10:34,044 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 15:10:34,045 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'список рп', Было ли цензурировано: False
2025-07-18 15:10:34,045 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 15:10:34,045 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'список рп'
2025-07-18 15:10:34,045 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 7175749771 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 15:10:34,045 - INFO - aiogram.event - Update id=836455708 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 15:10:39,394 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'магазин' от пользователя 7175749771 в чате -1002640920461.
2025-07-18 15:10:39,394 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'магазин'
2025-07-18 15:10:39,394 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'магазин' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 15:10:39,394 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 15:10:39,395 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'магазин', Было ли цензурировано: False
2025-07-18 15:10:39,395 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 15:10:39,395 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'магазин'
2025-07-18 15:10:39,395 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 7175749771 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 15:10:39,396 - INFO - aiogram.event - Update id=836455709 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 15:10:43,578 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'писька' от пользователя 7175749771 в чате -1002640920461.
2025-07-18 15:10:43,579 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'писька'
2025-07-18 15:10:43,579 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'писька' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 15:10:43,579 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 15:10:43,580 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'писька', Было ли цензурировано: False
2025-07-18 15:10:43,580 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 15:10:43,580 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'писька'
2025-07-18 15:10:43,580 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 7175749771 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 15:10:43,580 - INFO - aiogram.event - Update id=836455710 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 15:10:47,631 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'окак' от пользователя 7175749771 в чате -1002640920461.
2025-07-18 15:10:47,631 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'окак'
2025-07-18 15:10:47,631 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'окак' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 15:10:47,631 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 15:10:47,631 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 4: '&#$%'
2025-07-18 15:10:47,632 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'окак', заменено на '&#$%'
2025-07-18 15:10:47,632 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: '&#$%', Было ли цензурировано: True
2025-07-18 15:10:47,632 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=True
2025-07-18 15:10:47,633 - INFO - censor_module - censor_message_handler: ЦЕНЗУРА ОБНАРУЖЕНА: Оригинал: 'окак', Цензурировано: '&#$%'. Найденные слова: ['окак']
2025-07-18 15:10:47,633 - DEBUG - censor_module - censor_message_handler: Попытка удалить сообщение 2299 от пользователя 7175749771.
2025-07-18 15:10:48,814 - INFO - censor_module - censor_message_handler: Сообщение 2299 от пользователя 7175749771 УСПЕШНО удалено.
2025-07-18 15:10:48,814 - DEBUG - censor_module - censor_message_handler: Попытка отправить цензурированное сообщение в чат -1002640920461: '<b>ᅠ</b> имел в виду: "&#$%"'
2025-07-18 15:10:49,222 - INFO - censor_module - censor_message_handler: Цензурированное сообщение УСПЕШНО отправлено в чат -1002640920461.
2025-07-18 15:10:49,222 - INFO - aiogram.event - Update id=836455711 is handled. Duration 1594 ms by bot id=6543660809
2025-07-18 15:11:07,587 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001BF4DA9B380>
2025-07-18 15:11:07,588 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001BF4DA9B380> completed
2025-07-18 15:11:07,588 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA3010>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752840667.587706))
2025-07-18 15:11:07,588 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001BF54AA3010>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752840667.587706)) completed
2025-07-18 15:11:07,588 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001BF4DDB9040>)
2025-07-18 15:11:07,588 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001BF4DDB9040>) completed
2025-07-18 15:11:07,589 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001BF4DDB9040>)
2025-07-18 15:11:07,589 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001BF4DDB9040>) completed
2025-07-18 15:11:07,589 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001BF54AA3010>)
2025-07-18 15:11:07,589 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001BF54AA3010>) completed
2025-07-18 15:11:11,792 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 15:11:12,046 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 15:11:12,046 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 15:11:12,046 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 15:11:12,047 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001BF54AA15D0>)
2025-07-18 15:11:12,047 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001BF54AA15D0>) completed
2025-07-18 15:11:12,048 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 15:11:12,048 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 15:11:12,048 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 15:11:12,048 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 15:11:12,049 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
