2025-07-18 20:56:32,562 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 20:56:33,098 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 20:56:33,100 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 20:56:33,101 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 20:56:33,101 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 20:56:33,102 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001B682D0E020>
2025-07-18 20:56:33,104 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001B682D0E020> completed
2025-07-18 20:56:33,104 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 20:56:33,105 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 20:56:33,106 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001B682C69E40>)
2025-07-18 20:56:33,106 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001B682C69E40>) completed
2025-07-18 20:56:33,107 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001B682CEC4C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 20:56:33,109 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001B682CEC4C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 20:56:33,109 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001B682CEC4C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 20:56:33,111 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001B682CEC4C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 20:56:33,116 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001B682CEC4C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 20:56:33,116 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001B682CEC4C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 20:56:33,117 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001B682C69E40>)
2025-07-18 20:56:33,118 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001B682C69E40>) completed
2025-07-18 20:56:33,119 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 20:56:33,120 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 20:56:33,120 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 20:56:33,120 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 20:56:33,122 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001B682D0E340>
2025-07-18 20:56:33,122 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001B682D0E340> completed
2025-07-18 20:56:33,123 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 20:56:33,124 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 20:56:33,125 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 20:56:33,126 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 20:56:33,127 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 20:56:33,132 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 20:56:33,134 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 20:56:33,135 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 20:56:33,136 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 20:56:33,140 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 20:56:33,141 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 20:56:33,142 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 20:56:33,145 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 20:56:33,148 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 20:56:33,149 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 20:56:33,151 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 20:56:33,152 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 20:56:33,154 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001B682C6AC50>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 20:56:33,157 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001B682C6AC50>)
2025-07-18 20:56:33,158 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001B682C6AC50>) completed
2025-07-18 20:56:33,159 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001B682C6AC50>)
2025-07-18 20:56:33,159 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001B682C6AC50>) completed
2025-07-18 20:56:33,160 - INFO - database - Database initialized successfully.
2025-07-18 20:56:33,160 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 20:56:33,162 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 20:56:33,164 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 20:56:33,165 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 20:56:33,167 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 20:56:33,168 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 20:56:33,170 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 20:56:33,170 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 20:56:33,171 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 20:56:33,171 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 20:56:33,172 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt
2025-07-18 20:56:33,173 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt.
2025-07-18 20:56:33,173 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'список действий', 'почесать спинку', 'схватить за шею', 'толкнуть сильно', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'рп действия', 'спеть песню', 'попрощаться', 'разозлиться', 'команды рп', 'поцеловать', 'засмеяться', 'подмигнуть', 'превратить', 'испугаться', 'издеваться', 'список рп', 'погладить', 'покормить', 'подрочить', 'похлопать', 'постучать', 'успокоить', 'заплакать', 'удивиться', 'работать', 'здоровье', 'трахнуть', 'полечить', 'толкнуть', 'схватить', 'помахать', 'шлепнуть', 'пощечина', 'ущипнуть', 'обозвать', 'профиль', 'магазин', 'напоить', 'кивнуть', 'шепнуть', 'ударить', 'укусить', 'плюнуть', 'обидеть', 'моё хп', 'мое хп', 'обнять', 'уебать', 'пнуть', 'топ', 'хп']
2025-07-18 20:56:33,175 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 20:56:33,175 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 20:56:33,176 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 20:56:33,176 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 20:56:33,177 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 20:56:33,177 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 20:56:33,178 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 20:56:33,179 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 20:56:33,180 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 20:56:33,180 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 20:56:33,181 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 20:56:33,181 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 20:56:33,183 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 20:56:33,183 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 20:56:33,184 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 20:56:33,184 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 20:56:33,184 - INFO - aiogram.dispatcher - Start polling
2025-07-18 20:56:33,185 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 20:56:33,185 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 20:56:33,186 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 20:56:33,339 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 20:56:33,405 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'Обнять' от пользователя 5157172276 в чате -1002640920461.
2025-07-18 20:56:33,406 - DEBUG - censor_module - censor_message_handler: Сообщение 'Обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 20:56:33,406 - ERROR - censor_module - censor_message_handler: Ошибка при прямом вызове обработчика для 'обнять': handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
Traceback (most recent call last):
  File "C:\Users\Student2-4\MRS_bot-3\censor_module.py", line 195, in censor_message_handler
    await handler_func(**handler_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
2025-07-18 20:56:33,409 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'Обнять' от пользователя 5157172276 в чате -1002640920461.
2025-07-18 20:56:33,410 - DEBUG - censor_module - censor_message_handler: Сообщение 'Обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 20:56:33,410 - ERROR - censor_module - censor_message_handler: Ошибка при прямом вызове обработчика для 'обнять': handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
Traceback (most recent call last):
  File "C:\Users\Student2-4\MRS_bot-3\censor_module.py", line 195, in censor_message_handler
    await handler_func(**handler_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
2025-07-18 20:56:34,418 - INFO - aiogram.event - Update id=836455776 is handled. Duration 1015 ms by bot id=6543660809
2025-07-18 20:56:34,535 - INFO - aiogram.event - Update id=836455777 is handled. Duration 1125 ms by bot id=6543660809
2025-07-18 21:02:11,416 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 21:02:11,677 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 21:02:11,678 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 21:02:11,679 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 21:02:11,679 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001B682C69E40>)
2025-07-18 21:02:11,680 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001B682C69E40>) completed
2025-07-18 21:02:11,681 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 21:02:11,681 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 21:02:11,682 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 21:02:11,682 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:02:11,685 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 21:02:17,700 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 21:02:18,232 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 21:02:18,235 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 21:02:18,235 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 21:02:18,235 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 21:02:18,236 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000021BD8BCE020>
2025-07-18 21:02:18,237 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000021BD8BCE020> completed
2025-07-18 21:02:18,238 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 21:02:18,238 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 21:02:18,239 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021BD8B29D50>)
2025-07-18 21:02:18,239 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021BD8B29D50>) completed
2025-07-18 21:02:18,240 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021BD8BAC3C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 21:02:18,241 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021BD8BAC3C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 21:02:18,242 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021BD8BAC3C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 21:02:18,244 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021BD8BAC3C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 21:02:18,247 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021BD8BAC3C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 21:02:18,248 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021BD8BAC3C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 21:02:18,249 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021BD8B29D50>)
2025-07-18 21:02:18,249 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021BD8B29D50>) completed
2025-07-18 21:02:18,250 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 21:02:18,251 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 21:02:18,251 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 21:02:18,251 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 21:02:18,254 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000021BD8BCC860>
2025-07-18 21:02:18,256 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000021BD8BCC860> completed
2025-07-18 21:02:18,256 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 21:02:18,257 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 21:02:18,258 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:02:18,259 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:02:18,260 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:02:18,261 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:02:18,268 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 21:02:18,270 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 21:02:18,271 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:02:18,272 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:02:18,273 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:02:18,274 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:02:18,275 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 21:02:18,276 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 21:02:18,277 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 21:02:18,278 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 21:02:18,282 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:02:18,287 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000021BD8B2AB60>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:02:18,287 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021BD8B2AB60>)
2025-07-18 21:02:18,288 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021BD8B2AB60>) completed
2025-07-18 21:02:18,288 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021BD8B2AB60>)
2025-07-18 21:02:18,289 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021BD8B2AB60>) completed
2025-07-18 21:02:18,289 - INFO - database - Database initialized successfully.
2025-07-18 21:02:18,290 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 21:02:18,291 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 21:02:18,291 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 21:02:18,291 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:02:18,292 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:02:18,292 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:02:18,293 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 21:02:18,293 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 21:02:18,294 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 21:02:18,294 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 21:02:18,295 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt
2025-07-18 21:02:18,297 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt.
2025-07-18 21:02:18,297 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'список действий', 'почесать спинку', 'схватить за шею', 'толкнуть сильно', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'рп действия', 'спеть песню', 'попрощаться', 'разозлиться', 'команды рп', 'поцеловать', 'засмеяться', 'подмигнуть', 'превратить', 'испугаться', 'издеваться', 'список рп', 'погладить', 'покормить', 'подрочить', 'похлопать', 'постучать', 'успокоить', 'заплакать', 'удивиться', 'работать', 'здоровье', 'трахнуть', 'полечить', 'толкнуть', 'схватить', 'помахать', 'шлепнуть', 'пощечина', 'ущипнуть', 'обозвать', 'профиль', 'магазин', 'напоить', 'кивнуть', 'шепнуть', 'ударить', 'укусить', 'плюнуть', 'обидеть', 'моё хп', 'мое хп', 'обнять', 'уебать', 'пнуть', 'топ', 'хп']
2025-07-18 21:02:18,301 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 21:02:18,302 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 21:02:18,303 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 21:02:18,303 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 21:02:18,304 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 21:02:18,304 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 21:02:18,304 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 21:02:18,305 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 21:02:18,305 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 21:02:18,305 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 21:02:18,306 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 21:02:18,306 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 21:02:18,308 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 21:02:18,308 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 21:02:18,308 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 21:02:18,309 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 21:02:18,309 - INFO - aiogram.dispatcher - Start polling
2025-07-18 21:02:18,310 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 21:02:18,310 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 21:02:18,310 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 21:02:18,464 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:04:16,426 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'обнять' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:04:16,427 - DEBUG - censor_module - censor_message_handler: Сообщение 'обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 21:04:16,428 - DEBUG - core.group.RP.rmain - handle_rp_action_via_text: Received text message: 'обнять' from user 5315054003.
2025-07-18 21:04:16,429 - ERROR - censor_module - censor_message_handler: Ошибка при прямом вызове обработчика для 'обнять': name 're' is not defined
Traceback (most recent call last):
  File "C:\Users\Student2-4\MRS_bot-3\censor_module.py", line 195, in censor_message_handler
    await handler_func(**handler_args)
  File "C:\Users\Student2-4\MRS_bot-3\rp_module_refactored.py", line 186, in handle_rp_action_via_text
    match = re.match(r"^(.*?)(?:\s+@(\w+))?$", command_text_payload.lower())
            ^^
NameError: name 're' is not defined. Did you forget to import 're'
2025-07-18 21:04:16,928 - INFO - aiogram.event - Update id=836455778 is handled. Duration 515 ms by bot id=6543660809
2025-07-18 21:04:31,897 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 21:04:32,157 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 21:04:32,158 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 21:04:32,159 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 21:04:32,159 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021BD8B29D50>)
2025-07-18 21:04:32,160 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021BD8B29D50>) completed
2025-07-18 21:04:32,160 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 21:04:32,161 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 21:04:32,161 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 21:04:32,162 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:04:32,172 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 21:04:38,232 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 21:04:38,833 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 21:04:38,835 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 21:04:38,836 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 21:04:38,836 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 21:04:38,837 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001FB5CDBE0C0>
2025-07-18 21:04:38,838 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001FB5CDBE0C0> completed
2025-07-18 21:04:38,839 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 21:04:38,839 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 21:04:38,840 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001FB5CD19D50>)
2025-07-18 21:04:38,841 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001FB5CD19D50>) completed
2025-07-18 21:04:38,842 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001FB5CD98240>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 21:04:38,843 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001FB5CD98240>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 21:04:38,844 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001FB5CD98240>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 21:04:38,850 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001FB5CD98240>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 21:04:38,851 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001FB5CD98240>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 21:04:38,852 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001FB5CD98240>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 21:04:38,854 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001FB5CD19D50>)
2025-07-18 21:04:38,855 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001FB5CD19D50>) completed
2025-07-18 21:04:38,855 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 21:04:38,856 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 21:04:38,856 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 21:04:38,856 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 21:04:38,857 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001FB5CDBE3E0>
2025-07-18 21:04:38,857 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001FB5CDBE3E0> completed
2025-07-18 21:04:38,858 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 21:04:38,859 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 21:04:38,860 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:04:38,861 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:04:38,862 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:04:38,868 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:04:38,870 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 21:04:38,872 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 21:04:38,873 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:04:38,874 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:04:38,878 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:04:38,883 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:04:38,885 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 21:04:38,886 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 21:04:38,886 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 21:04:38,888 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 21:04:38,889 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:04:38,890 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1AB60>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:04:38,891 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001FB5CD1AB60>)
2025-07-18 21:04:38,892 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001FB5CD1AB60>) completed
2025-07-18 21:04:38,892 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CD1AB60>)
2025-07-18 21:04:38,893 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CD1AB60>) completed
2025-07-18 21:04:38,894 - INFO - database - Database initialized successfully.
2025-07-18 21:04:38,894 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 21:04:38,895 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 21:04:38,895 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 21:04:38,896 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:04:38,898 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:04:38,900 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:04:38,901 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 21:04:38,901 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 21:04:38,902 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 21:04:38,902 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 21:04:38,902 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt
2025-07-18 21:04:38,903 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt.
2025-07-18 21:04:38,904 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'список действий', 'почесать спинку', 'схватить за шею', 'толкнуть сильно', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'рп действия', 'спеть песню', 'попрощаться', 'разозлиться', 'команды рп', 'поцеловать', 'засмеяться', 'подмигнуть', 'превратить', 'испугаться', 'издеваться', 'список рп', 'погладить', 'покормить', 'подрочить', 'похлопать', 'постучать', 'успокоить', 'заплакать', 'удивиться', 'работать', 'здоровье', 'трахнуть', 'полечить', 'толкнуть', 'схватить', 'помахать', 'шлепнуть', 'пощечина', 'ущипнуть', 'обозвать', 'профиль', 'магазин', 'напоить', 'кивнуть', 'шепнуть', 'ударить', 'укусить', 'плюнуть', 'обидеть', 'моё хп', 'мое хп', 'обнять', 'уебать', 'пнуть', 'топ', 'хп']
2025-07-18 21:04:38,905 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 21:04:38,906 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 21:04:38,906 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 21:04:38,907 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 21:04:38,907 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 21:04:38,907 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 21:04:38,907 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 21:04:38,908 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 21:04:38,908 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 21:04:38,908 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 21:04:38,909 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 21:04:38,909 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 21:04:38,911 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 21:04:38,911 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 21:04:38,911 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 21:04:38,911 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 21:04:38,912 - INFO - aiogram.dispatcher - Start polling
2025-07-18 21:04:38,912 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 21:04:38,914 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 21:04:38,915 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 21:04:39,068 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:04:45,933 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'обнять' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:04:45,934 - DEBUG - censor_module - censor_message_handler: Сообщение 'обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 21:04:45,935 - DEBUG - core.group.RP.rmain - handle_rp_action_via_text: Received text message: 'обнять' from user 5315054003.
2025-07-18 21:04:45,935 - INFO - core.group.RP.rmain - handle_rp_action_via_text: Processing RP action 'обнять' (via text) for user 5315054003.
2025-07-18 21:04:45,936 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001FB5CDEFBA0>
2025-07-18 21:04:45,937 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001FB5CDEFBA0> completed
2025-07-18 21:04:45,938 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CEBC040>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:04:45,939 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CEBC040>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:04:45,940 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CEBC040>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:04:45,943 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CEBC040>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:04:45,944 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000001FB58499540>)
2025-07-18 21:04:45,944 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000001FB58499540>) completed
2025-07-18 21:04:45,947 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001FB58499540>)
2025-07-18 21:04:45,948 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001FB58499540>) completed
2025-07-18 21:04:45,953 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CEBC040>)
2025-07-18 21:04:45,955 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CEBC040>) completed
2025-07-18 21:04:45,957 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001FB5CDEFD80>
2025-07-18 21:04:45,958 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001FB5CDEFD80> completed
2025-07-18 21:04:45,959 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1BE20>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:04:45,960 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1BE20>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:04:45,961 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1BE20>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:04:45,962 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1BE20>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:04:45,966 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000001FB58499BC0>)
2025-07-18 21:04:45,967 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x000001FB58499BC0>) completed
2025-07-18 21:04:45,968 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001FB58499BC0>)
2025-07-18 21:04:45,968 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001FB58499BC0>) completed
2025-07-18 21:04:45,969 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CD1BE20>)
2025-07-18 21:04:45,969 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CD1BE20>) completed
2025-07-18 21:04:45,970 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001FB5389F240>
2025-07-18 21:04:45,971 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001FB5389F240> completed
2025-07-18 21:04:45,972 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1BD30>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:04:45,974 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1BD30>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:04:45,975 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1BD30>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (101, 5315054003))
2025-07-18 21:04:45,977 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001FB5CD1BD30>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (101, 5315054003)) completed
2025-07-18 21:04:45,978 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001FB5CD1BD30>)
2025-07-18 21:04:45,997 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001FB5CD1BD30>) completed
2025-07-18 21:04:46,001 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CD1BD30>)
2025-07-18 21:04:46,004 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CD1BD30>) completed
2025-07-18 21:04:46,545 - INFO - core.group.RP.rmain - RP Action 'обнять' performed by 5315054003. Sender HP: 101.
2025-07-18 21:04:46,830 - INFO - core.group.RP.rmain - Original message 2409 deleted after RP action.
2025-07-18 21:04:46,831 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'обнять' успешно выполнен. Завершение обработки сообщения.
2025-07-18 21:04:46,831 - INFO - aiogram.event - Update id=836455779 is handled. Duration 890 ms by bot id=6543660809
2025-07-18 21:10:37,176 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 21:10:37,436 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 21:10:37,437 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 21:10:37,437 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 21:10:37,438 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CD19D50>)
2025-07-18 21:10:37,438 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001FB5CD19D50>) completed
2025-07-18 21:10:37,439 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 21:10:37,439 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 21:10:37,440 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 21:10:37,440 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:10:37,442 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 21:10:45,168 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 21:10:45,891 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 21:10:45,892 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 21:10:45,898 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 21:10:45,919 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 21:10:45,920 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001756982E020>
2025-07-18 21:10:45,922 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001756982E020> completed
2025-07-18 21:10:45,923 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 21:10:45,924 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 21:10:45,925 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000017569789E40>)
2025-07-18 21:10:45,925 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000017569789E40>) completed
2025-07-18 21:10:45,926 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000175697FC3C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 21:10:45,927 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000175697FC3C0>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 21:10:45,928 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000175697FC3C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 21:10:45,933 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000175697FC3C0>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 21:10:45,935 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000175697FC3C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 21:10:45,936 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000175697FC3C0>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 21:10:45,937 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000017569789E40>)
2025-07-18 21:10:45,939 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000017569789E40>) completed
2025-07-18 21:10:45,940 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 21:10:45,940 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 21:10:45,941 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 21:10:45,941 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 21:10:45,942 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000001756982C860>
2025-07-18 21:10:45,942 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000001756982C860> completed
2025-07-18 21:10:45,943 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 21:10:45,944 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 21:10:45,944 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:10:45,945 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:10:45,949 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:10:45,953 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:10:45,954 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 21:10:45,955 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 21:10:45,955 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:10:45,956 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:10:45,957 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:10:45,958 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:10:45,959 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 21:10:45,960 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 21:10:45,961 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 21:10:45,962 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 21:10:45,969 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:10:45,970 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x000001756978AC50>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:10:45,972 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001756978AC50>)
2025-07-18 21:10:45,972 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001756978AC50>) completed
2025-07-18 21:10:45,973 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001756978AC50>)
2025-07-18 21:10:45,973 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001756978AC50>) completed
2025-07-18 21:10:45,974 - INFO - database - Database initialized successfully.
2025-07-18 21:10:45,974 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 21:10:45,975 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 21:10:45,975 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 21:10:45,975 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:10:45,976 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:10:45,976 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:10:45,977 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 21:10:45,978 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 21:10:45,978 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 21:10:45,978 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 21:10:45,979 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt
2025-07-18 21:10:45,980 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt.
2025-07-18 21:10:45,986 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'список действий', 'почесать спинку', 'схватить за шею', 'толкнуть сильно', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'рп действия', 'спеть песню', 'попрощаться', 'разозлиться', 'команды рп', 'поцеловать', 'засмеяться', 'подмигнуть', 'превратить', 'испугаться', 'издеваться', 'список рп', 'погладить', 'покормить', 'подрочить', 'похлопать', 'постучать', 'успокоить', 'заплакать', 'удивиться', 'работать', 'здоровье', 'трахнуть', 'полечить', 'толкнуть', 'схватить', 'помахать', 'шлепнуть', 'пощечина', 'ущипнуть', 'обозвать', 'профиль', 'магазин', 'напоить', 'кивнуть', 'шепнуть', 'ударить', 'укусить', 'плюнуть', 'обидеть', 'моё хп', 'мое хп', 'обнять', 'уебать', 'пнуть', 'топ', 'хп']
2025-07-18 21:10:45,991 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 21:10:45,991 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 21:10:45,992 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 21:10:45,993 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 21:10:45,994 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 21:10:45,994 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 21:10:45,994 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 21:10:45,995 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 21:10:45,995 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 21:10:45,995 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 21:10:45,997 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 21:10:46,001 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 21:10:46,002 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 21:10:46,002 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 21:10:46,003 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 21:10:46,003 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 21:10:46,003 - INFO - aiogram.dispatcher - Start polling
2025-07-18 21:10:46,004 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 21:10:46,006 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 21:10:46,007 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 21:10:46,172 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:10:54,038 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'обнять' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:10:54,038 - DEBUG - censor_module - censor_message_handler: Сообщение 'обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 21:10:54,039 - ERROR - censor_module - censor_message_handler: Ошибка при прямом вызове обработчика для 'обнять': handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
Traceback (most recent call last):
  File "C:\Users\Student2-4\MRS_bot-3\censor_module.py", line 195, in censor_message_handler
    await handler_func(**handler_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: handle_rp_action_via_text() got an unexpected keyword argument 'command_text_payload'
2025-07-18 21:10:54,509 - INFO - aiogram.event - Update id=836455780 is handled. Duration 484 ms by bot id=6543660809
2025-07-18 21:11:01,800 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 21:11:02,054 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 21:11:02,055 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 21:11:02,055 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 21:11:02,056 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000017569789E40>)
2025-07-18 21:11:02,057 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000017569789E40>) completed
2025-07-18 21:11:02,057 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 21:11:02,058 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 21:11:02,058 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 21:11:02,059 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:11:02,061 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 21:11:08,510 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 21:11:09,087 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 21:11:09,089 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 21:11:09,089 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 21:11:09,089 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 21:11:09,090 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8760E0C0>
2025-07-18 21:11:09,091 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8760E0C0> completed
2025-07-18 21:11:09,092 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 21:11:09,092 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 21:11:09,092 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000025D87559D50>)
2025-07-18 21:11:09,093 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000025D87559D50>) completed
2025-07-18 21:11:09,094 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D875E8240>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 21:11:09,097 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D875E8240>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 21:11:09,098 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D875E8240>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 21:11:09,125 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D875E8240>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 21:11:09,126 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D875E8240>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 21:11:09,127 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D875E8240>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 21:11:09,127 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87559D50>)
2025-07-18 21:11:09,128 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87559D50>) completed
2025-07-18 21:11:09,128 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 21:11:09,128 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 21:11:09,129 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 21:11:09,129 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 21:11:09,136 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8760C9A0>
2025-07-18 21:11:09,138 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8760C9A0> completed
2025-07-18 21:11:09,142 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 21:11:09,144 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 21:11:09,151 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:11:09,152 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:11:09,153 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:11:09,155 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:11:09,156 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 21:11:09,158 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 21:11:09,160 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:11:09,162 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:11:09,172 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:11:09,173 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:11:09,174 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 21:11:09,174 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 21:11:09,176 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 21:11:09,183 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 21:11:09,188 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:11:09,192 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755AB60>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:11:09,193 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D8755AB60>)
2025-07-18 21:11:09,193 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D8755AB60>) completed
2025-07-18 21:11:09,193 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D8755AB60>)
2025-07-18 21:11:09,194 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D8755AB60>) completed
2025-07-18 21:11:09,194 - INFO - database - Database initialized successfully.
2025-07-18 21:11:09,195 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 21:11:09,196 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 21:11:09,200 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 21:11:09,201 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:11:09,201 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:11:09,201 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:11:09,202 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 21:11:09,203 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 21:11:09,203 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 21:11:09,204 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 21:11:09,204 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt
2025-07-18 21:11:09,205 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt.
2025-07-18 21:11:09,205 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'список действий', 'почесать спинку', 'схватить за шею', 'толкнуть сильно', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'рп действия', 'спеть песню', 'попрощаться', 'разозлиться', 'команды рп', 'поцеловать', 'засмеяться', 'подмигнуть', 'превратить', 'испугаться', 'издеваться', 'список рп', 'погладить', 'покормить', 'подрочить', 'похлопать', 'постучать', 'успокоить', 'заплакать', 'удивиться', 'работать', 'здоровье', 'трахнуть', 'полечить', 'толкнуть', 'схватить', 'помахать', 'шлепнуть', 'пощечина', 'ущипнуть', 'обозвать', 'профиль', 'магазин', 'напоить', 'кивнуть', 'шепнуть', 'ударить', 'укусить', 'плюнуть', 'обидеть', 'моё хп', 'мое хп', 'обнять', 'уебать', 'пнуть', 'топ', 'хп']
2025-07-18 21:11:09,207 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 21:11:09,208 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 21:11:09,208 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 21:11:09,209 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 21:11:09,209 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 21:11:09,209 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 21:11:09,209 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 21:11:09,210 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 21:11:09,210 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 21:11:09,210 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 21:11:09,211 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 21:11:09,212 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 21:11:09,215 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 21:11:09,216 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 21:11:09,217 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 21:11:09,217 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 21:11:09,218 - INFO - aiogram.dispatcher - Start polling
2025-07-18 21:11:09,218 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 21:11:09,218 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 21:11:09,219 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 21:11:09,389 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:11:09,465 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'обнять' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:11:09,465 - DEBUG - censor_module - censor_message_handler: Сообщение 'обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 21:11:09,466 - DEBUG - core.group.RP.rmain - handle_rp_action_via_text: Received text message: 'обнять' from user 5315054003.
2025-07-18 21:11:09,466 - INFO - core.group.RP.rmain - handle_rp_action_via_text: Processing RP action 'обнять' (via text) for user 5315054003.
2025-07-18 21:11:09,467 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8763FBA0>
2025-07-18 21:11:09,468 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8763FBA0> completed
2025-07-18 21:11:09,468 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704040>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:11:09,469 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704040>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:11:09,470 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704040>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:11:09,471 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704040>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:11:09,473 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D82D155C0>)
2025-07-18 21:11:09,473 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D82D155C0>) completed
2025-07-18 21:11:09,474 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D82D155C0>)
2025-07-18 21:11:09,474 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D82D155C0>) completed
2025-07-18 21:11:09,475 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87704040>)
2025-07-18 21:11:09,475 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87704040>) completed
2025-07-18 21:11:09,476 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8763FD80>
2025-07-18 21:11:09,477 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8763FD80> completed
2025-07-18 21:11:09,480 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BE20>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:11:09,486 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BE20>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:11:09,487 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BE20>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:11:09,489 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BE20>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:11:09,490 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D82D16540>)
2025-07-18 21:11:09,490 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D82D16540>) completed
2025-07-18 21:11:09,491 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D82D16540>)
2025-07-18 21:11:09,491 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D82D16540>) completed
2025-07-18 21:11:09,492 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D8755BE20>)
2025-07-18 21:11:09,492 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D8755BE20>) completed
2025-07-18 21:11:09,493 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025DFDFDF240>
2025-07-18 21:11:09,494 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025DFDFDF240> completed
2025-07-18 21:11:09,494 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BD30>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:11:09,497 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BD30>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:11:09,500 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BD30>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (106, 5315054003))
2025-07-18 21:11:09,501 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BD30>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (106, 5315054003)) completed
2025-07-18 21:11:09,502 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D8755BD30>)
2025-07-18 21:11:09,657 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D8755BD30>) completed
2025-07-18 21:11:09,658 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D8755BD30>)
2025-07-18 21:11:09,659 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D8755BD30>) completed
2025-07-18 21:11:10,193 - INFO - core.group.RP.rmain - RP Action 'обнять' performed by 5315054003. Sender HP: 106.
2025-07-18 21:11:10,462 - INFO - core.group.RP.rmain - Original message 2413 deleted after RP action.
2025-07-18 21:11:10,462 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'обнять' успешно выполнен. Завершение обработки сообщения.
2025-07-18 21:11:10,463 - INFO - aiogram.event - Update id=836455781 is handled. Duration 1000 ms by bot id=6543660809
2025-07-18 21:11:19,830 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'обнять' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:11:19,831 - DEBUG - censor_module - censor_message_handler: Сообщение 'обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 21:11:19,831 - DEBUG - core.group.RP.rmain - handle_rp_action_via_text: Received text message: 'обнять' from user 5315054003.
2025-07-18 21:11:19,831 - INFO - core.group.RP.rmain - handle_rp_action_via_text: Processing RP action 'обнять' (via text) for user 5315054003.
2025-07-18 21:11:19,832 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8763F740>
2025-07-18 21:11:19,834 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8763F740> completed
2025-07-18 21:11:19,835 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704220>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:11:19,837 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704220>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:11:19,838 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704220>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:11:19,839 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704220>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:11:19,839 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D82D158C0>)
2025-07-18 21:11:19,840 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D82D158C0>) completed
2025-07-18 21:11:19,841 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D82D158C0>)
2025-07-18 21:11:19,843 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D82D158C0>) completed
2025-07-18 21:11:19,844 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87704220>)
2025-07-18 21:11:19,846 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87704220>) completed
2025-07-18 21:11:19,849 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8763EAC0>
2025-07-18 21:11:19,850 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8763EAC0> completed
2025-07-18 21:11:19,851 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704220>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:11:19,855 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704220>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:11:19,856 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704220>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:11:19,856 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87704220>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:11:19,857 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D82D158C0>)
2025-07-18 21:11:19,857 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D82D158C0>) completed
2025-07-18 21:11:19,858 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D82D158C0>)
2025-07-18 21:11:19,858 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D82D158C0>) completed
2025-07-18 21:11:19,858 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87704220>)
2025-07-18 21:11:19,859 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87704220>) completed
2025-07-18 21:11:19,860 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8763F740>
2025-07-18 21:11:19,861 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8763F740> completed
2025-07-18 21:11:19,861 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D877044F0>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:11:19,862 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D877044F0>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:11:19,866 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D877044F0>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (111, 5315054003))
2025-07-18 21:11:19,868 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D877044F0>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (111, 5315054003)) completed
2025-07-18 21:11:19,869 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D877044F0>)
2025-07-18 21:11:20,101 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D877044F0>) completed
2025-07-18 21:11:20,101 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D877044F0>)
2025-07-18 21:11:20,102 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D877044F0>) completed
2025-07-18 21:11:20,386 - INFO - core.group.RP.rmain - RP Action 'обнять' performed by 5315054003. Sender HP: 111.
2025-07-18 21:11:20,626 - INFO - core.group.RP.rmain - Original message 2415 deleted after RP action.
2025-07-18 21:11:20,626 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'обнять' успешно выполнен. Завершение обработки сообщения.
2025-07-18 21:11:20,627 - INFO - aiogram.event - Update id=836455782 is handled. Duration 797 ms by bot id=6543660809
2025-07-18 21:20:45,929 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'пиздец' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:20:45,929 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'пиздец'
2025-07-18 21:20:45,930 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'пиздец' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:20:45,932 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:20:45,938 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 6: '#%&$@&'
2025-07-18 21:20:45,939 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'пиздец', заменено на '#%&$@&'
2025-07-18 21:20:45,940 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: '#%&$@&', Было ли цензурировано: True
2025-07-18 21:20:45,940 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=True
2025-07-18 21:20:45,941 - INFO - censor_module - censor_message_handler: ЦЕНЗУРА ОБНАРУЖЕНА: Оригинал: 'пиздец', Цензурировано: '#%&$@&'. Найденные слова: ['пиздец']
2025-07-18 21:20:45,941 - DEBUG - censor_module - censor_message_handler: Попытка удалить сообщение 2417 от пользователя 5315054003.
2025-07-18 21:20:46,264 - INFO - censor_module - censor_message_handler: Сообщение 2417 от пользователя 5315054003 УСПЕШНО удалено.
2025-07-18 21:20:46,265 - DEBUG - censor_module - censor_message_handler: Попытка отправить цензурированное сообщение в чат -1002640920461: '<b>彼岸花</b> имел в виду: "#%&$@&"'
2025-07-18 21:20:46,617 - INFO - censor_module - censor_message_handler: Цензурированное сообщение УСПЕШНО отправлено в чат -1002640920461.
2025-07-18 21:20:46,619 - INFO - aiogram.event - Update id=836455783 is handled. Duration 702 ms by bot id=6543660809
2025-07-18 21:20:50,442 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'пиздец' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:20:50,443 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'пиздец'
2025-07-18 21:20:50,443 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'пиздец' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:20:50,444 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:20:50,446 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 6: '#&@^&@'
2025-07-18 21:20:50,446 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'пиздец', заменено на '#&@^&@'
2025-07-18 21:20:50,447 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: '#&@^&@', Было ли цензурировано: True
2025-07-18 21:20:50,447 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=True
2025-07-18 21:20:50,448 - INFO - censor_module - censor_message_handler: ЦЕНЗУРА ОБНАРУЖЕНА: Оригинал: 'пиздец', Цензурировано: '#&@^&@'. Найденные слова: ['пиздец']
2025-07-18 21:20:50,448 - DEBUG - censor_module - censor_message_handler: Попытка удалить сообщение 2419 от пользователя 5315054003.
2025-07-18 21:20:50,626 - INFO - censor_module - censor_message_handler: Сообщение 2419 от пользователя 5315054003 УСПЕШНО удалено.
2025-07-18 21:20:50,626 - DEBUG - censor_module - censor_message_handler: Попытка отправить цензурированное сообщение в чат -1002640920461: '<b>彼岸花</b> имел в виду: "#&@^&@"'
2025-07-18 21:20:50,854 - INFO - censor_module - censor_message_handler: Цензурированное сообщение УСПЕШНО отправлено в чат -1002640920461.
2025-07-18 21:20:50,854 - INFO - aiogram.event - Update id=836455784 is handled. Duration 422 ms by bot id=6543660809
2025-07-18 21:20:53,279 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'пиздец' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:20:53,280 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'пиздец'
2025-07-18 21:20:53,280 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'пиздец' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:20:53,284 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:20:53,289 - DEBUG - censor_module - censor_module.generate_random_symbols: Сгенерированы случайные символы длиной 6: '&%@#&#'
2025-07-18 21:20:53,289 - DEBUG - censor_module - censor_module.censor_text_func: Обнаружено совпадение 'пиздец', заменено на '&%@#&#'
2025-07-18 21:20:53,290 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: '&%@#&#', Было ли цензурировано: True
2025-07-18 21:20:53,290 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=True
2025-07-18 21:20:53,291 - INFO - censor_module - censor_message_handler: ЦЕНЗУРА ОБНАРУЖЕНА: Оригинал: 'пиздец', Цензурировано: '&%@#&#'. Найденные слова: ['пиздец']
2025-07-18 21:20:53,292 - DEBUG - censor_module - censor_message_handler: Попытка удалить сообщение 2421 от пользователя 5315054003.
2025-07-18 21:20:53,457 - INFO - censor_module - censor_message_handler: Сообщение 2421 от пользователя 5315054003 УСПЕШНО удалено.
2025-07-18 21:20:53,458 - DEBUG - censor_module - censor_message_handler: Попытка отправить цензурированное сообщение в чат -1002640920461: '<b>彼岸花</b> имел в виду: "&%@#&#"'
2025-07-18 21:20:53,752 - INFO - censor_module - censor_message_handler: Цензурированное сообщение УСПЕШНО отправлено в чат -1002640920461.
2025-07-18 21:20:53,754 - INFO - aiogram.event - Update id=836455785 is handled. Duration 469 ms by bot id=6543660809
2025-07-18 21:21:07,386 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'щывалпывщалщывхза' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:07,387 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'щывалпывщалщывхза'
2025-07-18 21:21:07,388 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'щывалпывщалщывхза' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:21:07,391 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:21:07,396 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'щывалпывщалщывхза', Было ли цензурировано: False
2025-07-18 21:21:07,396 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 21:21:07,399 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'щывалпывщалщывхза'
2025-07-18 21:21:07,401 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 21:21:07,401 - INFO - aiogram.event - Update id=836455786 is handled. Duration 14 ms by bot id=6543660809
2025-07-18 21:21:07,548 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'ыва' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:07,548 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'ыва'
2025-07-18 21:21:07,549 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'ыва' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:21:07,550 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:21:07,552 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'ыва', Было ли цензурировано: False
2025-07-18 21:21:07,552 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 21:21:07,553 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'ыва'
2025-07-18 21:21:07,553 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 21:21:07,553 - INFO - aiogram.event - Update id=836455787 is handled. Duration 14 ms by bot id=6543660809
2025-07-18 21:21:07,668 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'ыв' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:07,669 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'ыв'
2025-07-18 21:21:07,670 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'ыв' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:21:07,671 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:21:07,673 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'ыв', Было ли цензурировано: False
2025-07-18 21:21:07,674 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 21:21:07,674 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'ыв'
2025-07-18 21:21:07,675 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 21:21:07,675 - INFO - aiogram.event - Update id=836455788 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 21:21:07,821 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'ываыв' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:07,821 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'ываыв'
2025-07-18 21:21:07,822 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'ываыв' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:21:07,824 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:21:07,825 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'ываыв', Было ли цензурировано: False
2025-07-18 21:21:07,826 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 21:21:07,826 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'ываыв'
2025-07-18 21:21:07,827 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 21:21:07,828 - INFO - aiogram.event - Update id=836455789 is handled. Duration 15 ms by bot id=6543660809
2025-07-18 21:21:07,943 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'а' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:07,943 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'а'
2025-07-18 21:21:07,944 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'а' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:21:07,945 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:21:07,955 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'а', Было ли цензурировано: False
2025-07-18 21:21:07,956 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 21:21:07,957 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'а'
2025-07-18 21:21:07,957 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 21:21:07,958 - INFO - aiogram.event - Update id=836455790 is handled. Duration 15 ms by bot id=6543660809
2025-07-18 21:21:08,097 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'аыв' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:08,098 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'аыв'
2025-07-18 21:21:08,100 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'аыв' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:21:08,102 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:21:08,106 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'аыв', Было ли цензурировано: False
2025-07-18 21:21:08,107 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 21:21:08,108 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'аыв'
2025-07-18 21:21:08,108 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 21:21:08,109 - INFO - aiogram.event - Update id=836455791 is handled. Duration 15 ms by bot id=6543660809
2025-07-18 21:21:09,042 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'аыва' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:09,042 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'аыва'
2025-07-18 21:21:09,043 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'аыва' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:21:09,044 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:21:09,046 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'аыва', Было ли цензурировано: False
2025-07-18 21:21:09,046 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 21:21:09,047 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'аыва'
2025-07-18 21:21:09,050 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 21:21:09,050 - INFO - aiogram.event - Update id=836455792 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 21:21:09,234 - DEBUG - core.group.RP.rmain - Periodic recovery: Checking for users to recover HP.
2025-07-18 21:21:09,235 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8760E340>
2025-07-18 21:21:09,236 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8760E340> completed
2025-07-18 21:21:09,237 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778040>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752862869.2344627))
2025-07-18 21:21:09,238 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778040>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752862869.2344627)) completed
2025-07-18 21:21:09,239 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000025D875EA040>)
2025-07-18 21:21:09,239 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000025D875EA040>) completed
2025-07-18 21:21:09,240 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D875EA040>)
2025-07-18 21:21:09,240 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D875EA040>) completed
2025-07-18 21:21:09,241 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87778040>)
2025-07-18 21:21:09,242 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87778040>) completed
2025-07-18 21:21:11,310 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'профиль' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:11,310 - DEBUG - censor_module - censor_message_handler: Сообщение 'профиль' является известной не-слеш командой 'профиль'. Попытка прямого вызова обработчика.
2025-07-18 21:21:11,311 - INFO - core.group.stat.smain - DEBUG: show_profile handler entered for user 5315054003 with text 'профиль'.
2025-07-18 21:21:11,312 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D87718E00>
2025-07-18 21:21:11,313 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D87718E00> completed
2025-07-18 21:21:11,315 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778A90>, '\n            INSERT INTO users (user_id, username, first_name, last_active_ts)\n            VALUES (?, ?, ?, ?)\n            ON CONFLICT(user_id) DO UPDATE SET\n                username = excluded.username,\n                first_name = excluded.first_name,\n                last_active_ts = excluded.last_active_ts\n        ', (5315054003, 'Cel0brek', '彼岸花', 1752862871.31148))
2025-07-18 21:21:11,318 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778A90>, '\n            INSERT INTO users (user_id, username, first_name, last_active_ts)\n            VALUES (?, ?, ?, ?)\n            ON CONFLICT(user_id) DO UPDATE SET\n                username = excluded.username,\n                first_name = excluded.first_name,\n                last_active_ts = excluded.last_active_ts\n        ', (5315054003, 'Cel0brek', '彼岸花', 1752862871.31148)) completed
2025-07-18 21:21:11,320 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778A90>, "\n            INSERT OR IGNORE INTO user_modes (user_id, mode, rating_opportunities_count)\n            VALUES (?, 'saharoza', 0)\n        ", (5315054003,))
2025-07-18 21:21:11,321 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778A90>, "\n            INSERT OR IGNORE INTO user_modes (user_id, mode, rating_opportunities_count)\n            VALUES (?, 'saharoza', 0)\n        ", (5315054003,)) completed
2025-07-18 21:21:11,322 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778A90>, '\n            INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)\n        ', (5315054003,))
2025-07-18 21:21:11,323 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778A90>, '\n            INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)\n        ', (5315054003,)) completed
2025-07-18 21:21:11,324 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87778A90>)
2025-07-18 21:21:11,349 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87778A90>) completed
2025-07-18 21:21:11,350 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87778A90>)
2025-07-18 21:21:11,350 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87778A90>) completed
2025-07-18 21:21:11,351 - DEBUG - core.group.stat.smain - Fetching or creating profile for user_id: 5315054003
2025-07-18 21:21:11,351 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000025D87559D50>)
2025-07-18 21:21:11,352 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000025D87559D50>) completed
2025-07-18 21:21:11,353 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D87701840>, '\n            INSERT INTO users (user_id, username, first_name, last_name)\n            VALUES (?, ?, ?, ?)\n            ON CONFLICT(user_id) DO UPDATE SET\n                username = excluded.username,\n                first_name = excluded.first_name,\n                last_name = excluded.last_name\n        ', (5315054003, 'Cel0brek', '彼岸花', None))
2025-07-18 21:21:11,354 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D87701840>, '\n            INSERT INTO users (user_id, username, first_name, last_name)\n            VALUES (?, ?, ?, ?)\n            ON CONFLICT(user_id) DO UPDATE SET\n                username = excluded.username,\n                first_name = excluded.first_name,\n                last_name = excluded.last_name\n        ', (5315054003, 'Cel0brek', '彼岸花', None)) completed
2025-07-18 21:21:11,355 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87559D50>)
2025-07-18 21:21:11,355 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87559D50>) completed
2025-07-18 21:21:11,356 - DEBUG - core.group.stat.smain - User 5315054003 information updated/inserted in 'profiles.db users' table.
2025-07-18 21:21:11,356 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D87701840>, '\n        INSERT OR IGNORE INTO user_profiles (user_id)\n        VALUES (?)\n        ', (5315054003,))
2025-07-18 21:21:11,358 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D87701840>, '\n        INSERT OR IGNORE INTO user_profiles (user_id)\n        VALUES (?)\n        ', (5315054003,)) completed
2025-07-18 21:21:11,359 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87559D50>)
2025-07-18 21:21:11,405 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87559D50>) completed
2025-07-18 21:21:11,405 - DEBUG - core.group.stat.smain - User profile for 5315054003 ensured existence in 'profiles.db user_profiles' table.
2025-07-18 21:21:11,406 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D87701840>, '\n        SELECT * FROM user_profiles WHERE user_id = ?\n        ', (5315054003,))
2025-07-18 21:21:11,407 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000025D87701840>, '\n        SELECT * FROM user_profiles WHERE user_id = ?\n        ', (5315054003,)) completed
2025-07-18 21:21:11,407 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D87701840>)
2025-07-18 21:21:11,408 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D87701840>) completed
2025-07-18 21:21:11,409 - DEBUG - core.group.stat.smain - Profile data retrieved for user_id 5315054003 from profiles.db.
2025-07-18 21:21:11,409 - DEBUG - core.group.stat.smain - Display name set to: @Cel0brek for user 5315054003.
2025-07-18 21:21:11,410 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8763CEA0>
2025-07-18 21:21:11,414 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8763CEA0> completed
2025-07-18 21:21:11,415 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D877789A0>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:21:11,416 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D877789A0>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:21:11,417 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D877789A0>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:21:11,417 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D877789A0>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:21:11,419 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D877009C0>)
2025-07-18 21:21:11,419 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D877009C0>) completed
2025-07-18 21:21:11,419 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D877009C0>)
2025-07-18 21:21:11,420 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D877009C0>) completed
2025-07-18 21:21:11,421 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D877789A0>)
2025-07-18 21:21:11,422 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D877789A0>) completed
2025-07-18 21:21:11,422 - DEBUG - core.group.stat.smain - HP fetched from database.py: 111 for user 5315054003.
2025-07-18 21:21:11,423 - INFO - core.group.stat.smain - Successfully retrieved/created profile for user 5315054003.
2025-07-18 21:21:11,423 - DEBUG - core.group.stat.smain - Generating profile image for user 5315054003.
2025-07-18 21:21:11,424 - INFO - core.group.stat.smain - Starting profile image generation for user 5315054003.
2025-07-18 21:21:11,433 - INFO - core.group.stat.smain - Font 'Hlobus.ttf' loaded successfully and cached.
2025-07-18 21:21:11,434 - DEBUG - core.group.stat.smain - Fonts retrieved from cache.
2025-07-18 21:21:11,436 - DEBUG - core.group.stat.smain - Base image and draw object created for the card.
2025-07-18 21:21:11,436 - DEBUG - core.group.stat.smain - Card shadow drawn.
2025-07-18 21:21:11,437 - DEBUG - core.group.stat.smain - Background Loading: Step 1 - Attempting to load background from local path: background/defolt.jpg.
2025-07-18 21:21:11,455 - DEBUG - core.group.stat.smain - Background Loading: Step 2 - Local background image opened with PIL and converted to RGBA.
2025-07-18 21:21:11,461 - DEBUG - core.group.stat.smain - Background Loading: Step 3 - Background image resized to 672x280.
2025-07-18 21:21:11,462 - DEBUG - core.group.stat.smain - Background Loading: Step 4 - Background image cropped to fit card dimensions.
2025-07-18 21:21:11,464 - INFO - core.group.stat.smain - Background Loading: Step 5 - Rounded corner mask applied to background image.
2025-07-18 21:21:11,467 - DEBUG - core.group.stat.smain - Background image pasted onto base card.
2025-07-18 21:21:11,467 - DEBUG - core.group.stat.smain - Avatar Collection: Step 1 - Attempting to get profile photos for user ID: 5315054003 from Telegram.
2025-07-18 21:21:11,612 - INFO - core.group.stat.smain - Avatar Collection: Step 2.1 - No profile photos found for user 5315054003. Initiating fallback to default placeholder.
2025-07-18 21:21:11,612 - WARNING - core.group.stat.smain - Avatar Collection: Primary avatar retrieval failed for user 5315054003: No profile photos. Attempting to load default placeholder from URL.
Traceback (most recent call last):
  File "C:\Users\Student2-4\MRS_bot-3\core\group\stat\manager.py", line 375, in generate_profile_image
    raise ValueError("No profile photos")
ValueError: No profile photos
2025-07-18 21:21:11,616 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 1 - Attempting to download default avatar from URL: https://placehold.co/120x120/CCCCCC/FFFFFF/png?text=AV.
2025-07-18 21:21:12,068 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 2 - Default avatar downloaded. Opening with PIL and converting to RGBA.
2025-07-18 21:21:12,068 - DEBUG - PIL.PngImagePlugin - STREAM b'IHDR' 16 13
2025-07-18 21:21:12,069 - DEBUG - PIL.PngImagePlugin - STREAM b'pHYs' 41 9
2025-07-18 21:21:12,069 - DEBUG - PIL.PngImagePlugin - STREAM b'IDAT' 62 1369
2025-07-18 21:21:12,070 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 3 - Resizing default avatar to 120x120.
2025-07-18 21:21:12,071 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 4 - Creating circular mask for the default avatar.
2025-07-18 21:21:12,071 - DEBUG - core.group.stat.smain - Avatar Collection: Fallback Step 5 - Applying mask to default avatar to make it circular.
2025-07-18 21:21:12,072 - INFO - core.group.stat.smain - Avatar Collection: Default avatar placeholder loaded successfully from URL.
2025-07-18 21:21:12,072 - DEBUG - core.group.stat.smain - Avatar Collection: Pasting the determined avatar image onto the base card image.
2025-07-18 21:21:12,073 - DEBUG - core.group.stat.smain - Avatar pasted onto base image.
2025-07-18 21:21:12,074 - DEBUG - core.group.stat.smain - Coin icon drawn on avatar.
2025-07-18 21:21:12,074 - DEBUG - core.group.stat.smain - Profile data for image: Display Name: @Cel0brek, Level: 1, EXP: 11, Lumcoins: 117, HP: 111.
2025-07-18 21:21:12,076 - DEBUG - core.group.stat.smain - Text '@Cel0brek' drawn with shadow at (165, 84).
2025-07-18 21:21:12,076 - DEBUG - core.group.stat.smain - Left-central text block (username) drawn.
2025-07-18 21:21:12,077 - DEBUG - core.group.stat.smain - Calculating required EXP for level 1.
2025-07-18 21:21:12,077 - DEBUG - core.group.stat.smain - Required EXP for level 1: 105.
2025-07-18 21:21:12,078 - DEBUG - core.group.stat.smain - Text 'Experience' drawn with shadow at (30, 205).
2025-07-18 21:21:12,079 - DEBUG - core.group.stat.smain - Experience label drawn.
2025-07-18 21:21:12,079 - DEBUG - core.group.stat.smain - EXP Bar: current_exp_percentage=0.10476190476190476, fill_width=59.
2025-07-18 21:21:12,080 - DEBUG - core.group.stat.smain - EXP bar background drawn.
2025-07-18 21:21:12,081 - DEBUG - core.group.stat.smain - EXP bar filled with green gradient with transparency.
2025-07-18 21:21:12,082 - DEBUG - core.group.stat.smain - Text '11/105' drawn with shadow at (615, 231).
2025-07-18 21:21:12,083 - DEBUG - core.group.stat.smain - Experience progress text '11/105' drawn.
2025-07-18 21:21:12,083 - DEBUG - core.group.stat.smain - Text 'HP' drawn with shadow at (651, 50).
2025-07-18 21:21:12,084 - DEBUG - core.group.stat.smain - Text '❤️ 111' drawn with shadow at (619, 75).
2025-07-18 21:21:12,085 - DEBUG - core.group.stat.smain - Right column HP text drawn.
2025-07-18 21:21:12,086 - DEBUG - core.group.stat.smain - Text 'LumCoins' drawn with shadow at (589, 120).
2025-07-18 21:21:12,087 - DEBUG - core.group.stat.smain - Text '₽ 117' drawn with shadow at (614, 145).
2025-07-18 21:21:12,087 - DEBUG - core.group.stat.smain - Right column Lumcoins text drawn.
2025-07-18 21:21:12,113 - INFO - core.group.stat.smain - Profile image generation completed for user 5315054003.
2025-07-18 21:21:12,113 - INFO - core.group.stat.smain - Sending profile image to user 5315054003.
2025-07-18 21:21:12,642 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'магазин' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:12,643 - DEBUG - censor_module - censor_message_handler: Сообщение 'магазин' является известной не-слеш командой 'магазин'. Попытка прямого вызова обработчика.
2025-07-18 21:21:12,643 - INFO - core.group.stat.smain - Received 'магазин' command from user 5315054003.
2025-07-18 21:21:12,643 - DEBUG - core.group.stat.smain - Retrieving available backgrounds from shop configuration.
2025-07-18 21:21:12,645 - DEBUG - core.group.stat.smain - Shop items compiled: {'space': {'name': 'Космос', 'url': 'https://images.unsplash.com/photo-1506318137072-291786a88698?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFjZXxlbnwwfHwwfHww&auto=format&fit=crop&w=600&q=80', 'cost': 50}, 'nature': {'name': 'Природа', 'url': 'https://images.unsplash.com/photo-1440330559787-852571c1c71a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDF8fG5hdHVyZXxlbnwwfHwwfHww&auto=format&fit=crop&w=600&q=80', 'cost': 40}, 'city': {'name': 'Город', 'url': 'https://images.unsplash.com/photo-1519013876546-8858ba07e532?ixlib=rb-4.0.3&ixid=M3wxMjA3fDF8fGNpdHl8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=600&q=80', 'cost': 60}, 'abstract': {'name': 'Абстракция', 'url': 'https://images.unsplash.com/photo-1508768787810-6adc1f09aeda?ixlib=rb-4.0.3&ixid=M3wxMjA3fDdzfHxhYnN0cmFjdHxlbnwwfHwwfHww&auto=format&fit=crop&w=600&q=80', 'cost': 30}}.
2025-07-18 21:21:12,776 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'профиль' успешно выполнен. Завершение обработки сообщения.
2025-07-18 21:21:12,777 - INFO - aiogram.event - Update id=836455793 is handled. Duration 1468 ms by bot id=6543660809
2025-07-18 21:21:13,076 - INFO - core.group.stat.smain - Shop list sent to user 5315054003.
2025-07-18 21:21:13,076 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'магазин' успешно выполнен. Завершение обработки сообщения.
2025-07-18 21:21:13,077 - INFO - aiogram.event - Update id=836455794 is handled. Duration 436 ms by bot id=6543660809
2025-07-18 21:21:22,544 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'space' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:22,545 - DEBUG - censor_module - censor_message_handler: Вызов censor_text_func для текста: 'space'
2025-07-18 21:21:22,545 - DEBUG - censor_module - censor_module.censor_text_func: Начата обработка текста: 'space' с корнями: ['пизд', 'хуй', 'елда', 'член', 'хуе', 'долба', 'пен', 'еб', 'ёб', 'бл', 'сперм', 'шлю', 'соса', 'пизд', 'хуй', 'елда', 'член', 'овощ', 'окак', 'короче', 'пизда', 'уёбище', 'бдсм', 'фетиш', 'фашист', 'адольф', 'гитлер', 'стинтлер', 'шлюх', 'раф', 'кун', 'даня', 'челобрек', 'мама', 'мать', 'секс', 'папа', 'батя', 'отец', 'минет', 'бля', 'кунилингус', 'трах']
2025-07-18 21:21:22,547 - DEBUG - censor_module - censor_module.censor_text_func: Сформировано объединенное регулярное выражение: '\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*х+\W*у+\W*е+\w*)\b|\b(?:\w*д+\W*о+\W*л+\W*б+\W*а+\w*)\b|\b(?:\w*п+\W*е+\W*н+\w*)\b|\b(?:\w*е+\W*б+\w*)\b|\b(?:\w*ё+\W*б+\w*)\b|\b(?:\w*б+\W*л+\w*)\b|\b(?:\w*с+\W*п+\W*е+\W*р+\W*м+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\w*)\b|\b(?:\w*с+\W*о+\W*с+\W*а+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\w*)\b|\b(?:\w*х+\W*у+\W*й+\w*)\b|\b(?:\w*е+\W*л+\W*д+\W*а+\w*)\b|\b(?:\w*ч+\W*л+\W*е+\W*н+\w*)\b|\b(?:\w*о+\W*в+\W*о+\W*щ+\w*)\b|\b(?:\w*о+\W*к+\W*а+\W*к+\w*)\b|\b(?:\w*к+\W*о+\W*р+\W*о+\W*ч+\W*е+\w*)\b|\b(?:\w*п+\W*и+\W*з+\W*д+\W*а+\w*)\b|\b(?:\w*у+\W*ё+\W*б+\W*и+\W*щ+\W*е+\w*)\b|\b(?:\w*б+\W*д+\W*с+\W*м+\w*)\b|\b(?:\w*ф+\W*е+\W*т+\W*и+\W*ш+\w*)\b|\b(?:\w*ф+\W*а+\W*ш+\W*и+\W*с+\W*т+\w*)\b|\b(?:\w*а+\W*д+\W*о+\W*л+\W*ь+\W*ф+\w*)\b|\b(?:\w*г+\W*и+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*с+\W*т+\W*и+\W*н+\W*т+\W*л+\W*е+\W*р+\w*)\b|\b(?:\w*ш+\W*л+\W*ю+\W*х+\w*)\b|\b(?:\w*р+\W*а+\W*ф+\w*)\b|\b(?:\w*к+\W*у+\W*н+\w*)\b|\b(?:\w*д+\W*а+\W*н+\W*я+\w*)\b|\b(?:\w*ч+\W*е+\W*л+\W*о+\W*б+\W*р+\W*е+\W*к+\w*)\b|\b(?:\w*м+\W*а+\W*м+\W*а+\w*)\b|\b(?:\w*м+\W*а+\W*т+\W*ь+\w*)\b|\b(?:\w*с+\W*е+\W*к+\W*с+\w*)\b|\b(?:\w*п+\W*а+\W*п+\W*а+\w*)\b|\b(?:\w*б+\W*а+\W*т+\W*я+\w*)\b|\b(?:\w*о+\W*т+\W*е+\W*ц+\w*)\b|\b(?:\w*м+\W*и+\W*н+\W*е+\W*т+\w*)\b|\b(?:\w*б+\W*л+\W*я+\w*)\b|\b(?:\w*к+\W*у+\W*н+\W*и+\W*л+\W*и+\W*н+\W*г+\W*у+\W*с+\w*)\b|\b(?:\w*т+\W*р+\W*а+\W*х+\w*)\b'
2025-07-18 21:21:22,549 - DEBUG - censor_module - censor_module.censor_text_func: Конечный цензурированный текст: 'space', Было ли цензурировано: False
2025-07-18 21:21:22,549 - DEBUG - censor_module - censor_message_handler: Результат censor_text_func: was_censored=False
2025-07-18 21:21:22,550 - DEBUG - censor_module - censor_message_handler: ЦЕНЗУРА НЕ ОБНАРУЖЕНА: Оригинал: 'space'
2025-07-18 21:21:22,551 - DEBUG - censor_module - censor_message_handler: Сообщение от пользователя 5315054003 не требует цензуры. Сообщение будет передано для дальнейшей обработки.
2025-07-18 21:21:22,551 - INFO - aiogram.event - Update id=836455795 is handled. Duration 0 ms by bot id=6543660809
2025-07-18 21:21:28,746 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'обнять' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:28,748 - DEBUG - censor_module - censor_message_handler: Сообщение 'обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 21:21:28,749 - DEBUG - core.group.RP.rmain - handle_rp_action_via_text: Received text message: 'обнять' from user 5315054003.
2025-07-18 21:21:28,750 - INFO - core.group.RP.rmain - handle_rp_action_via_text: Processing RP action 'обнять' (via text) for user 5315054003.
2025-07-18 21:21:28,751 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025DFDFDF240>
2025-07-18 21:21:28,753 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025DFDFDF240> completed
2025-07-18 21:21:28,754 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825A80>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:21:28,756 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825A80>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:21:28,757 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825A80>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:21:28,758 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825A80>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:21:28,758 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D85E35F40>)
2025-07-18 21:21:28,759 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D85E35F40>) completed
2025-07-18 21:21:28,760 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D85E35F40>)
2025-07-18 21:21:28,760 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D85E35F40>) completed
2025-07-18 21:21:28,761 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87825A80>)
2025-07-18 21:21:28,761 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87825A80>) completed
2025-07-18 21:21:28,762 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D87718CC0>
2025-07-18 21:21:28,764 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D87718CC0> completed
2025-07-18 21:21:28,765 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825A80>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:21:28,766 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825A80>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:21:28,767 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825A80>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:21:28,767 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825A80>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:21:28,768 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D85E35DC0>)
2025-07-18 21:21:28,768 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D85E35DC0>) completed
2025-07-18 21:21:28,768 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D85E35DC0>)
2025-07-18 21:21:28,769 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D85E35DC0>) completed
2025-07-18 21:21:28,770 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87825A80>)
2025-07-18 21:21:28,770 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87825A80>) completed
2025-07-18 21:21:28,771 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D87857420>
2025-07-18 21:21:28,772 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D87857420> completed
2025-07-18 21:21:28,773 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87824D60>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:21:28,774 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87824D60>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:21:28,774 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87824D60>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (116, 5315054003))
2025-07-18 21:21:28,776 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87824D60>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (116, 5315054003)) completed
2025-07-18 21:21:28,776 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87824D60>)
2025-07-18 21:21:28,934 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87824D60>) completed
2025-07-18 21:21:28,935 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87824D60>)
2025-07-18 21:21:28,936 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87824D60>) completed
2025-07-18 21:21:29,236 - INFO - core.group.RP.rmain - RP Action 'обнять' performed by 5315054003. Sender HP: 116.
2025-07-18 21:21:29,427 - INFO - core.group.RP.rmain - Original message 2435 deleted after RP action.
2025-07-18 21:21:29,427 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'обнять' успешно выполнен. Завершение обработки сообщения.
2025-07-18 21:21:29,428 - INFO - aiogram.event - Update id=836455796 is handled. Duration 686 ms by bot id=6543660809
2025-07-18 21:21:34,894 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'обнять' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:21:34,895 - DEBUG - censor_module - censor_message_handler: Сообщение 'обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 21:21:34,895 - DEBUG - core.group.RP.rmain - handle_rp_action_via_text: Received text message: 'обнять' from user 5315054003.
2025-07-18 21:21:34,896 - INFO - core.group.RP.rmain - handle_rp_action_via_text: Processing RP action 'обнять' (via text) for user 5315054003.
2025-07-18 21:21:34,897 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D87718F40>
2025-07-18 21:21:34,900 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D87718F40> completed
2025-07-18 21:21:34,901 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825210>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:21:34,902 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825210>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:21:34,903 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825210>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:21:34,904 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87825210>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:21:34,904 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D87680140>)
2025-07-18 21:21:34,905 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D87680140>) completed
2025-07-18 21:21:34,905 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D87680140>)
2025-07-18 21:21:34,906 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D87680140>) completed
2025-07-18 21:21:34,906 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87825210>)
2025-07-18 21:21:34,907 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87825210>) completed
2025-07-18 21:21:34,908 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8763EF20>
2025-07-18 21:21:34,909 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8763EF20> completed
2025-07-18 21:21:34,910 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778310>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:21:34,911 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778310>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:21:34,912 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778310>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:21:34,912 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778310>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:21:34,914 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D876806C0>)
2025-07-18 21:21:34,915 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000025D876806C0>) completed
2025-07-18 21:21:34,916 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D876806C0>)
2025-07-18 21:21:34,918 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D876806C0>) completed
2025-07-18 21:21:34,919 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87778310>)
2025-07-18 21:21:34,919 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87778310>) completed
2025-07-18 21:21:34,921 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D87718F40>
2025-07-18 21:21:34,921 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D87718F40> completed
2025-07-18 21:21:34,922 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778130>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:21:34,923 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778130>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:21:34,924 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778130>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (121, 5315054003))
2025-07-18 21:21:34,926 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D87778130>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (121, 5315054003)) completed
2025-07-18 21:21:34,927 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87778130>)
2025-07-18 21:21:35,174 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000025D87778130>) completed
2025-07-18 21:21:35,174 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87778130>)
2025-07-18 21:21:35,175 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87778130>) completed
2025-07-18 21:21:35,481 - INFO - core.group.RP.rmain - RP Action 'обнять' performed by 5315054003. Sender HP: 121.
2025-07-18 21:21:35,718 - INFO - core.group.RP.rmain - Original message 2437 deleted after RP action.
2025-07-18 21:21:35,719 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'обнять' успешно выполнен. Завершение обработки сообщения.
2025-07-18 21:21:35,719 - INFO - aiogram.event - Update id=836455797 is handled. Duration 827 ms by bot id=6543660809
2025-07-18 21:31:09,249 - DEBUG - core.group.RP.rmain - Periodic recovery: Checking for users to recover HP.
2025-07-18 21:31:09,251 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000025D8763F920>
2025-07-18 21:31:09,253 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000025D8763F920> completed
2025-07-18 21:31:09,254 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BF10>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752863469.2504716))
2025-07-18 21:31:09,255 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000025D8755BF10>, '\n        SELECT user_id, hp\n        FROM rp_user_stats\n        WHERE hp <= ? AND recovery_end_ts > 0 AND recovery_end_ts <= ?\n    ', (0, 1752863469.2504716)) completed
2025-07-18 21:31:09,256 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000025D85EDF140>)
2025-07-18 21:31:09,257 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000025D85EDF140>) completed
2025-07-18 21:31:09,258 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D85EDF140>)
2025-07-18 21:31:09,259 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000025D85EDF140>) completed
2025-07-18 21:31:09,259 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D8755BF10>)
2025-07-18 21:31:09,260 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D8755BF10>) completed
2025-07-18 21:32:22,337 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 21:32:22,592 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 21:32:22,592 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 21:32:22,592 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 21:32:22,593 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87559D50>)
2025-07-18 21:32:22,594 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000025D87559D50>) completed
2025-07-18 21:32:22,595 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 21:32:22,595 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 21:32:22,595 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 21:32:22,596 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:32:22,599 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
2025-07-18 21:32:28,705 - WARNING - core.main.ez_main - CHANNEL_ID is not set or invalid. Jokes task will be disabled.
2025-07-18 21:32:29,541 - DEBUG - asyncio - Using proactor: IocpProactor
2025-07-18 21:32:29,545 - INFO - core.main.ez_main - main: Запуск основной функции бота.
2025-07-18 21:32:29,546 - INFO - core.group.stat.smain - ProfileManager instance initialized.
2025-07-18 21:32:29,546 - DEBUG - core.group.stat.smain - Attempting to connect to profiles database asynchronously.
2025-07-18 21:32:29,555 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002656631A160>
2025-07-18 21:32:29,561 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002656631A160> completed
2025-07-18 21:32:29,562 - INFO - core.group.stat.smain - Profiles database connected asynchronously.
2025-07-18 21:32:29,562 - DEBUG - core.group.stat.smain - Starting asynchronous profiles database schema initialization.
2025-07-18 21:32:29,564 - DEBUG - aiosqlite - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026566275D50>)
2025-07-18 21:32:29,564 - DEBUG - aiosqlite - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026566275D50>) completed
2025-07-18 21:32:29,567 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000265662FC140>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', [])
2025-07-18 21:32:29,569 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000265662FC140>, '\n        CREATE TABLE IF NOT EXISTS users (\n            user_id INTEGER PRIMARY KEY,\n            username TEXT,\n            first_name TEXT,\n            last_name TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n        ', []) completed
2025-07-18 21:32:29,570 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000265662FC140>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', [])
2025-07-18 21:32:29,572 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000265662FC140>, '\n        CREATE TABLE IF NOT EXISTS user_profiles (\n            profile_id INTEGER PRIMARY KEY AUTOINCREMENT,\n            user_id INTEGER UNIQUE,\n            hp INTEGER DEFAULT 100 CHECK(hp >= 0 AND hp <= 150),\n            level INTEGER DEFAULT 1 CHECK(level >= 1 AND level <= 169),\n            exp INTEGER DEFAULT 0,\n            lumcoins INTEGER DEFAULT 0,\n            daily_messages INTEGER DEFAULT 0,\n            total_messages INTEGER DEFAULT 0,\n            flames INTEGER DEFAULT 0,\n            last_work_time REAL DEFAULT 0,\n            FOREIGN KEY (user_id) REFERENCES users (user_id)\n        )\n        ', []) completed
2025-07-18 21:32:29,574 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000265662FC140>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', [])
2025-07-18 21:32:29,575 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000265662FC140>, 'CREATE INDEX IF NOT EXISTS idx_user_profiles_user_id ON user_profiles(user_id)', []) completed
2025-07-18 21:32:29,576 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026566275D50>)
2025-07-18 21:32:29,576 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026566275D50>) completed
2025-07-18 21:32:29,577 - INFO - core.group.stat.smain - Asynchronous profiles database tables checked/created.
2025-07-18 21:32:29,577 - INFO - core.group.stat.smain - Asynchronous profiles database schema check/initialization completed.
2025-07-18 21:32:29,577 - INFO - core.main.ez_main - main: ProfileManager подключен.
2025-07-18 21:32:29,578 - INFO - core.main.ez_main - main: Инициализация основной базы данных.
2025-07-18 21:32:29,584 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002656631A480>
2025-07-18 21:32:29,589 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002656631A480> completed
2025-07-18 21:32:29,590 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', [])
2025-07-18 21:32:29,591 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE TABLE IF NOT EXISTS users (\n                user_id INTEGER PRIMARY KEY,\n                username TEXT,\n                first_name TEXT NOT NULL,\n                last_active_ts REAL DEFAULT 0\n            )\n        ', []) completed
2025-07-18 21:32:29,592 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:32:29,593 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE TABLE IF NOT EXISTS value_subscriptions (\n                user_id INTEGER PRIMARY KEY,\n                subscribed_ts REAL NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:32:29,594 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:32:29,595 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, "\n            CREATE TABLE IF NOT EXISTS dialog_history (\n                history_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                role TEXT NOT NULL CHECK(role IN ('user', 'assistant')),\n                content TEXT NOT NULL,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:32:29,596 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', [])
2025-07-18 21:32:29,596 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE INDEX IF NOT EXISTS idx_dialog_history_user_ts ON dialog_history (user_id, timestamp DESC)\n        ', []) completed
2025-07-18 21:32:29,597 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:32:29,600 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, "\n            CREATE TABLE IF NOT EXISTS user_modes (\n                user_id INTEGER PRIMARY KEY,\n                mode TEXT NOT NULL DEFAULT 'saharoza',\n                rating_opportunities_count INTEGER DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:32:29,602 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", [])
2025-07-18 21:32:29,603 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, "\n            CREATE TABLE IF NOT EXISTS analytics_interactions (\n                interaction_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                timestamp REAL NOT NULL,\n                mode TEXT NOT NULL,\n                action_type TEXT NOT NULL DEFAULT 'message',\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ", []) completed
2025-07-18 21:32:29,604 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', [])
2025-07-18 21:32:29,607 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE INDEX IF NOT EXISTS idx_interactions_user_ts_mode ON analytics_interactions (user_id, timestamp DESC, mode)\n        ', []) completed
2025-07-18 21:32:29,610 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', [])
2025-07-18 21:32:29,611 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE TABLE IF NOT EXISTS analytics_ratings (\n                rating_id INTEGER PRIMARY KEY AUTOINCREMENT,\n                user_id INTEGER NOT NULL,\n                rated_message_id INTEGER,\n                dialog_history_id INTEGER,\n                timestamp REAL NOT NULL,\n                rating INTEGER NOT NULL CHECK(rating IN (0, 1)),\n                message_preview TEXT,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE,\n                FOREIGN KEY(dialog_history_id) REFERENCES dialog_history(history_id) ON DELETE SET NULL\n            )\n        ', []) completed
2025-07-18 21:32:29,612 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', [])
2025-07-18 21:32:29,613 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566276A70>, '\n            CREATE TABLE IF NOT EXISTS rp_user_stats (\n                user_id INTEGER PRIMARY KEY,\n                hp INTEGER NOT NULL DEFAULT 100,\n                heal_cooldown_ts REAL NOT NULL DEFAULT 0,\n                recovery_end_ts REAL NOT NULL DEFAULT 0,\n                FOREIGN KEY(user_id) REFERENCES users(user_id) ON DELETE CASCADE\n            )\n        ', []) completed
2025-07-18 21:32:29,616 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026566276A70>)
2025-07-18 21:32:29,617 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026566276A70>) completed
2025-07-18 21:32:29,617 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566276A70>)
2025-07-18 21:32:29,618 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566276A70>) completed
2025-07-18 21:32:29,618 - INFO - database - Database initialized successfully.
2025-07-18 21:32:29,619 - INFO - core.main.ez_main - main: Инициализация StickerManager и загрузка стикеров.
2025-07-18 21:32:29,619 - INFO - core.main.ez_main - Stickers loaded from cache.
2025-07-18 21:32:29,620 - INFO - core.main.ez_main - Fetching stickers from Telegram...
2025-07-18 21:32:29,622 - INFO - core.main.ez_main - Stickers for mode 'saharoza' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:32:29,623 - INFO - core.main.ez_main - Stickers for mode 'dedinside' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:32:29,623 - INFO - core.main.ez_main - Stickers for mode 'genius' already loaded (possibly from cache). Skipping fetch.
2025-07-18 21:32:29,624 - INFO - core.main.ez_main - Stickers saved to cache.
2025-07-18 21:32:29,625 - DEBUG - core.main.ez_main - main: Передача зависимостей в диспетчер.
2025-07-18 21:32:29,625 - INFO - core.main.ez_main - main: Настройка и включение модуля цензуры (первый приоритет для групп).
2025-07-18 21:32:29,625 - DEBUG - censor_module - setup_censor_handlers: Начата настройка модуля цензуры.
2025-07-18 21:32:29,626 - DEBUG - censor_module - censor_module.load_bad_words: Попытка загрузить слова из файла: C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt
2025-07-18 21:32:29,626 - INFO - censor_module - censor_module.load_bad_words: Успешно загружено 43 корней 'злых' слов из C:\Users\Student2-4\MRS_bot-3\data\bad_words.txt.
2025-07-18 21:32:29,627 - DEBUG - censor_module - setup_censor_handlers: Загружены не-слеш команды для игнорирования цензором: ['романтический поцелуй', 'поцеловать в щёчку', 'список действий', 'почесать спинку', 'схватить за шею', 'толкнуть сильно', 'прижать к себе', 'сделать массаж', 'подарить цветы', 'моё здоровье', 'мое здоровье', 'рп действия', 'спеть песню', 'попрощаться', 'разозлиться', 'команды рп', 'поцеловать', 'засмеяться', 'подмигнуть', 'превратить', 'испугаться', 'издеваться', 'список рп', 'погладить', 'покормить', 'подрочить', 'похлопать', 'постучать', 'успокоить', 'заплакать', 'удивиться', 'работать', 'здоровье', 'трахнуть', 'полечить', 'толкнуть', 'схватить', 'помахать', 'шлепнуть', 'пощечина', 'ущипнуть', 'обозвать', 'профиль', 'магазин', 'напоить', 'кивнуть', 'шепнуть', 'ударить', 'укусить', 'плюнуть', 'обидеть', 'моё хп', 'мое хп', 'обнять', 'уебать', 'пнуть', 'топ', 'хп']
2025-07-18 21:32:29,628 - DEBUG - censor_module - setup_censor_handlers: Включение censor_router в главный диспетчер.
2025-07-18 21:32:29,628 - INFO - censor_module - setup_censor_handlers: Обработчики модуля цензуры успешно настроены и включены в главный диспетчер.
2025-07-18 21:32:29,629 - INFO - core.main.ez_main - main: Модуль цензуры успешно интегрирован.
2025-07-18 21:32:29,630 - INFO - core.main.ez_main - main: Создан роутер для групповых текстовых сообщений.
2025-07-18 21:32:29,630 - INFO - core.main.ez_main - main: Включение stat_router в group_text_router.
2025-07-18 21:32:29,630 - INFO - core.group.stat.smain - Registering stat router handlers.
2025-07-18 21:32:29,631 - INFO - core.group.stat.smain - Stat router included in Dispatcher.
2025-07-18 21:32:29,632 - INFO - core.main.ez_main - main: Включение rp_router в group_text_router.
2025-07-18 21:32:29,632 - INFO - core.group.RP.rmain - RP router included and configured.
2025-07-18 21:32:29,632 - INFO - core.main.ez_main - main: group_text_router успешно интегрирован в главный диспетчер.
2025-07-18 21:32:29,634 - INFO - core.main.ez_main - main: Создан роутер для приватных чатов.
2025-07-18 21:32:29,634 - INFO - core.main.ez_main - main: Регистрация основных обработчиков команд ТОЛЬКО для приватных чатов.
2025-07-18 21:32:29,635 - INFO - core.main.ez_main - main: Основной обработчик текстовых сообщений для ЛС зарегистрирован в private_router.
2025-07-18 21:32:29,635 - INFO - core.main.ez_main - main: private_router успешно интегрирован в главный диспетчер.
2025-07-18 21:32:29,636 - INFO - core.main.ez_main - main: Запуск фоновых задач.
2025-07-18 21:32:29,636 - INFO - core.main.ez_main - main: Запуск поллинга бота...
2025-07-18 21:32:29,637 - INFO - aiogram.dispatcher - Start polling
2025-07-18 21:32:29,641 - INFO - core.main.ez_main - Jokes task started.
2025-07-18 21:32:29,641 - WARNING - core.main.ez_main - Jokes task disabled: CHANNEL_ID is not set or invalid.
2025-07-18 21:32:29,643 - INFO - core.group.RP.rmain - Periodic HP recovery task started.
2025-07-18 21:32:29,811 - INFO - aiogram.dispatcher - Run polling for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:32:33,787 - DEBUG - censor_module - censor_message_handler: Получено сообщение: 'обнять' от пользователя 5315054003 в чате -1002640920461.
2025-07-18 21:32:33,788 - DEBUG - censor_module - censor_message_handler: Сообщение 'обнять' является известной не-слеш командой 'обнять'. Попытка прямого вызова обработчика.
2025-07-18 21:32:33,789 - DEBUG - core.group.RP.rmain - handle_rp_action_via_text: Received text message: 'обнять' from user 5315054003.
2025-07-18 21:32:33,789 - INFO - core.group.RP.rmain - handle_rp_action_via_text: Processing RP action 'обнять' (via text) for user 5315054003. Target: None. Custom text: 'None'
2025-07-18 21:32:33,790 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002656634FE20>
2025-07-18 21:32:33,791 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002656634FE20> completed
2025-07-18 21:32:33,791 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566404040>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:32:33,792 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566404040>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:32:33,793 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566404040>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:32:33,793 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566404040>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:32:33,795 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000026561A358C0>)
2025-07-18 21:32:33,795 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000026561A358C0>) completed
2025-07-18 21:32:33,796 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026561A358C0>)
2025-07-18 21:32:33,796 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026561A358C0>) completed
2025-07-18 21:32:33,799 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566404040>)
2025-07-18 21:32:33,801 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566404040>) completed
2025-07-18 21:32:33,807 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x000002656634FBA0>
2025-07-18 21:32:33,808 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x000002656634FBA0> completed
2025-07-18 21:32:33,809 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566277C40>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:32:33,810 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566277C40>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:32:33,810 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566277C40>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,))
2025-07-18 21:32:33,811 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566277C40>, 'SELECT hp, heal_cooldown_ts, recovery_end_ts FROM rp_user_stats WHERE user_id = ?', (5315054003,)) completed
2025-07-18 21:32:33,812 - DEBUG - aiosqlite - executing functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000026561A35840>)
2025-07-18 21:32:33,812 - DEBUG - aiosqlite - operation functools.partial(<built-in method fetchone of sqlite3.Cursor object at 0x0000026561A35840>) completed
2025-07-18 21:32:33,813 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026561A35840>)
2025-07-18 21:32:33,813 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026561A35840>) completed
2025-07-18 21:32:33,817 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566277C40>)
2025-07-18 21:32:33,817 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566277C40>) completed
2025-07-18 21:32:33,819 - DEBUG - aiosqlite - executing <function connect.<locals>.connector at 0x0000026566318B80>
2025-07-18 21:32:33,819 - DEBUG - aiosqlite - operation <function connect.<locals>.connector at 0x0000026566318B80> completed
2025-07-18 21:32:33,820 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566277D30>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,))
2025-07-18 21:32:33,821 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566277D30>, 'INSERT OR IGNORE INTO rp_user_stats (user_id) VALUES (?)', (5315054003,)) completed
2025-07-18 21:32:33,822 - DEBUG - aiosqlite - executing functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566277D30>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (126, 5315054003))
2025-07-18 21:32:33,823 - DEBUG - aiosqlite - operation functools.partial(<built-in method execute of sqlite3.Connection object at 0x0000026566277D30>, 'UPDATE rp_user_stats SET hp = ? WHERE user_id = ?', (126, 5315054003)) completed
2025-07-18 21:32:33,824 - DEBUG - aiosqlite - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026566277D30>)
2025-07-18 21:32:33,901 - DEBUG - aiosqlite - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026566277D30>) completed
2025-07-18 21:32:33,902 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566277D30>)
2025-07-18 21:32:33,904 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566277D30>) completed
2025-07-18 21:32:34,510 - INFO - core.group.RP.rmain - RP Action 'обнять' performed by 5315054003. Sender HP: 126.
2025-07-18 21:32:34,741 - INFO - core.group.RP.rmain - Original message 2439 deleted after RP action.
2025-07-18 21:32:34,741 - INFO - censor_module - censor_message_handler: Прямой вызов обработчика для 'обнять' успешно выполнен. Завершение обработки сообщения.
2025-07-18 21:32:34,742 - INFO - aiogram.event - Update id=836455798 is handled. Duration 969 ms by bot id=6543660809
2025-07-18 21:38:34,526 - INFO - aiogram.dispatcher - Polling stopped
2025-07-18 21:38:34,781 - INFO - core.main.ez_main - main: Остановка бота...
2025-07-18 21:38:34,783 - INFO - core.main.ez_main - main: Фоновые задачи успешно отменены.
2025-07-18 21:38:34,784 - DEBUG - core.group.stat.smain - Attempting to close profiles database connection.
2025-07-18 21:38:34,785 - DEBUG - aiosqlite - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566275D50>)
2025-07-18 21:38:34,786 - DEBUG - aiosqlite - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026566275D50>) completed
2025-07-18 21:38:34,788 - INFO - core.group.stat.smain - Profiles database connection closed successfully.
2025-07-18 21:38:34,791 - INFO - core.main.ez_main - main: Соединение ProfileManager закрыто.
2025-07-18 21:38:34,792 - INFO - core.main.ez_main - main: Сессия бота закрыта. Выход.
2025-07-18 21:38:34,793 - INFO - aiogram.dispatcher - Polling stopped for bot @infernal_madam_bot id=6543660809 - 'Мэрри Шэдоу💔'
2025-07-18 21:38:34,795 - INFO - core.main.ez_main - main: Бот остановлен вручную (KeyboardInterrupt).
